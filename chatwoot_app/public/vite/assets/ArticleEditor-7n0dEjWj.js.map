{"version":3,"file":"ArticleEditor-7n0dEjWj.js","sources":["../../../node_modules/.pnpm/@chatwoot+prosemirror-schema@1.2.1/node_modules/@chatwoot/prosemirror-schema/src/plugins/image.js","../../../app/javascript/dashboard/components/widgets/WootWriter/FullEditor.vue","../../../app/javascript/dashboard/components-next/HelpCenter/Pages/ArticleEditorPage/ArticleEditorHeader.vue","../../../app/javascript/dashboard/components-next/HelpCenter/Pages/ArticleEditorPage/ArticleEditorProperties.vue","../../../app/javascript/dashboard/components-next/HelpCenter/Pages/ArticleEditorPage/ArticleEditorControls.vue","../../../app/javascript/dashboard/components-next/HelpCenter/Pages/ArticleEditorPage/ArticleEditor.vue"],"sourcesContent":["import { Plugin } from \"prosemirror-state\";\n\n/**\n * Replaces an image node in the editor with a new image URL.\n *\n * @param {string} currentUrl - The current URL of the image to be replaced.\n * @param {string} newUrl - The new URL to replace the current image with.\n * @param {EditorView} view - The ProseMirror editor view.\n */\nfunction replaceImage(currentUrl, newUrl, view) {\n  view.state.doc.descendants((node, pos) => {\n    if (node.type.name === \"image\" && node.attrs.src === currentUrl) {\n      const tr = view.state.tr.setNodeMarkup(pos, null, {\n        ...node.attrs,\n        src: newUrl,\n      });\n      view.dispatch(tr);\n    }\n  });\n}\n\n/**\n * Creates a ProseMirror plugin that handles image pasting and uploading.\n *\n * @param {Function} uploadImage - A function that takes an image URL and returns a Promise\n * that resolves to the new URL after uploading.\n * @returns {Plugin} A ProseMirror plugin that handles image pasting.\n */\nconst imagePastePlugin = (uploadImage) =>\n  new Plugin({\n    props: {\n      /**\n       * Handles the paste event in the editor.\n       *\n       * @param {EditorView} view - The ProseMirror editor view.\n       * @param {Event} event - The paste event.\n       * @param {Slice} slice - The ProseMirror Slice object representing the pasted content.\n       */\n      handlePaste(view, event, slice) {\n        const imageUrls = [];\n        slice.content.descendants((node) => {\n          if (node.type.name === \"image\") {\n            imageUrls.push(node.attrs.src);\n          }\n        });\n        Promise.all(imageUrls.map(async (url) => {\n          try {\n            const newUrl = await uploadImage(url);\n            replaceImage(url, newUrl, view);\n          } catch (error) {\n            console.error(\"Error uploading image:\", error);\n          }\n        }));\n      },\n    },\n  });\n\nexport default imagePastePlugin;\n","<script>\nimport {\n  fullSchema,\n  buildEditor,\n  EditorView,\n  ArticleMarkdownSerializer,\n  ArticleMarkdownTransformer,\n  EditorState,\n  Selection,\n} from '@chatwoot/prosemirror-schema';\nimport imagePastePlugin from '@chatwoot/prosemirror-schema/src/plugins/image';\nimport { checkFileSizeLimit } from 'shared/helpers/FileHelper';\nimport { useAlert } from 'dashboard/composables';\nimport { useUISettings } from 'dashboard/composables/useUISettings';\nimport keyboardEventListenerMixins from 'shared/mixins/keyboardEventListenerMixins';\n\nconst MAXIMUM_FILE_UPLOAD_SIZE = 4; // in MB\nconst createState = (\n  content,\n  placeholder,\n  // eslint-disable-next-line default-param-last\n  plugins = [],\n  // eslint-disable-next-line default-param-last\n  methods = {},\n  enabledMenuOptions\n) => {\n  return EditorState.create({\n    doc: new ArticleMarkdownTransformer(fullSchema).parse(content),\n    plugins: buildEditor({\n      schema: fullSchema,\n      placeholder,\n      methods,\n      plugins,\n      enabledMenuOptions,\n    }),\n  });\n};\n\nlet editorView = null;\nlet state;\n\nexport default {\n  mixins: [keyboardEventListenerMixins],\n  props: {\n    modelValue: { type: String, default: '' },\n    editorId: { type: String, default: '' },\n    placeholder: { type: String, default: '' },\n    enabledMenuOptions: { type: Array, default: () => [] },\n    autofocus: {\n      type: Boolean,\n      default: true,\n    },\n  },\n  emits: ['blur', 'input', 'update:modelValue', 'keyup', 'focus', 'keydown'],\n  setup() {\n    const { uiSettings, updateUISettings } = useUISettings();\n\n    return {\n      uiSettings,\n      updateUISettings,\n    };\n  },\n  data() {\n    return {\n      plugins: [imagePastePlugin(this.handleImageUpload)],\n      isTextSelected: false, // Tracks text selection and prevents unnecessary re-renders on mouse selection\n    };\n  },\n  watch: {\n    modelValue(newValue = '') {\n      if (newValue !== this.contentFromEditor()) {\n        this.reloadState();\n      }\n    },\n    editorId() {\n      this.reloadState();\n    },\n  },\n\n  created() {\n    state = createState(\n      this.modelValue,\n      this.placeholder,\n      this.plugins,\n      { onImageUpload: this.openFileBrowser },\n      this.enabledMenuOptions\n    );\n  },\n  mounted() {\n    this.createEditorView();\n\n    editorView.updateState(state);\n    if (this.autofocus) {\n      this.focusEditorInputField();\n    }\n  },\n  methods: {\n    contentFromEditor() {\n      if (editorView) {\n        return ArticleMarkdownSerializer.serialize(editorView.state.doc);\n      }\n      return '';\n    },\n    openFileBrowser() {\n      this.$refs.imageUploadInput.click();\n    },\n    async handleImageUpload(url) {\n      try {\n        const fileUrl = await this.$store.dispatch(\n          'articles/uploadExternalImage',\n          {\n            portalSlug: this.$route.params.portalSlug,\n            url,\n          }\n        );\n\n        return fileUrl;\n      } catch (error) {\n        useAlert(\n          this.$t('HELP_CENTER.ARTICLE_EDITOR.IMAGE_UPLOAD.UN_AUTHORIZED_ERROR')\n        );\n        return '';\n      }\n    },\n    onFileChange() {\n      const file = this.$refs.imageUploadInput.files[0];\n\n      if (checkFileSizeLimit(file, MAXIMUM_FILE_UPLOAD_SIZE)) {\n        this.uploadImageToStorage(file);\n      } else {\n        useAlert(\n          this.$t('HELP_CENTER.ARTICLE_EDITOR.IMAGE_UPLOAD.ERROR_FILE_SIZE', {\n            size: MAXIMUM_FILE_UPLOAD_SIZE,\n          })\n        );\n      }\n\n      this.$refs.imageUploadInput.value = '';\n    },\n    async uploadImageToStorage(file) {\n      try {\n        const fileUrl = await this.$store.dispatch('articles/attachImage', {\n          portalSlug: this.$route.params.portalSlug,\n          file,\n        });\n\n        if (fileUrl) {\n          this.onImageUploadStart(fileUrl);\n        }\n      } catch (error) {\n        useAlert(this.$t('HELP_CENTER.ARTICLE_EDITOR.IMAGE_UPLOAD.ERROR'));\n      }\n    },\n    onImageUploadStart(fileUrl) {\n      const { selection } = editorView.state;\n      const from = selection.from;\n      const node = editorView.state.schema.nodes.image.create({\n        src: fileUrl,\n      });\n      const paragraphNode = editorView.state.schema.node('paragraph');\n      if (node) {\n        // Insert the image and the caption wrapped inside a paragraph\n        const tr = editorView.state.tr\n          .replaceSelectionWith(paragraphNode)\n          .insert(from + 1, node);\n\n        editorView.dispatch(tr.scrollIntoView());\n        this.focusEditorInputField();\n      }\n    },\n    reloadState() {\n      state = createState(\n        this.modelValue,\n        this.placeholder,\n        this.plugins,\n        { onImageUpload: this.openFileBrowser },\n        this.enabledMenuOptions\n      );\n      editorView.updateState(state);\n      this.focusEditorInputField();\n    },\n    createEditorView() {\n      editorView = new EditorView(this.$refs.editor, {\n        state: state,\n        dispatchTransaction: tx => {\n          state = state.apply(tx);\n          editorView.updateState(state);\n          if (tx.docChanged) {\n            this.emitOnChange();\n          }\n          this.checkSelection(state);\n        },\n        handleDOMEvents: {\n          keyup: this.onKeyup,\n          focus: this.onFocus,\n          blur: this.onBlur,\n          keydown: this.onKeydown,\n          paste: (view, event) => {\n            const data = event.clipboardData.files;\n            if (data.length > 0) {\n              data.forEach(file => {\n                // Check if the file is an image\n                if (file.type.includes('image')) {\n                  this.uploadImageToStorage(file);\n                }\n              });\n              event.preventDefault();\n            }\n          },\n        },\n      });\n    },\n    handleKeyEvents() {},\n    focusEditorInputField() {\n      const { tr } = editorView.state;\n      const selection = Selection.atEnd(tr.doc);\n\n      editorView.dispatch(tr.setSelection(selection));\n      editorView.focus();\n    },\n    emitOnChange() {\n      this.$emit('update:modelValue', this.contentFromEditor());\n      this.$emit('input', this.contentFromEditor());\n    },\n    onKeyup() {\n      this.$emit('keyup');\n    },\n    onKeydown() {\n      this.$emit('keydown');\n    },\n    onBlur() {\n      this.$emit('blur');\n    },\n    onFocus() {\n      this.$emit('focus');\n    },\n    checkSelection(editorState) {\n      const { from, to } = editorState.selection;\n      // Check if there's a selection (from and to are different)\n      const hasSelection = from !== to;\n      // If the selection state is the same as the previous state, do nothing\n      if (hasSelection === this.isTextSelected) return;\n      // Update the selection state\n      this.isTextSelected = hasSelection;\n\n      const { editor } = this.$refs;\n\n      // Toggle the 'has-selection' class based on whether there's a selection\n      editor.classList.toggle('has-selection', hasSelection);\n      // If there's a selection, update the menubar position\n      if (hasSelection) this.setMenubarPosition(editorState);\n    },\n    setMenubarPosition(editorState) {\n      if (!editorState.selection) return;\n\n      // Get the start and end positions of the selection\n      const { from, to } = editorState.selection;\n      const { editor } = this.$refs;\n      // Get the editor's position relative to the viewport\n      const { left: editorLeft, top: editorTop } =\n        editor.getBoundingClientRect();\n\n      // Get the editor's width\n      const editorWidth = editor.offsetWidth;\n      const menubarWidth = 480; // Menubar width (adjust as needed (px))\n\n      // Get the end position of the selection\n      const { bottom: endBottom, right: endRight } = editorView.coordsAtPos(to);\n      // Get the start position of the selection\n      const { left: startLeft } = editorView.coordsAtPos(from);\n\n      // Calculate the top position for the menubar (10px below the selection)\n      const top = endBottom - editorTop + 10;\n      // Calculate the left position for the menubar\n      // This centers the menubar on the selection while keeping it within the editor's bounds\n      const left = Math.max(\n        0,\n        Math.min(\n          (startLeft + endRight) / 2 - editorLeft,\n          editorWidth - menubarWidth\n        )\n      );\n      // Set the CSS custom properties for positioning the menubar\n      editor.style.setProperty('--selection-top', `${top}px`);\n      editor.style.setProperty('--selection-left', `${left}px`);\n    },\n  },\n};\n</script>\n\n<template>\n  <div>\n    <div class=\"editor-root editor--article\">\n      <input\n        ref=\"imageUploadInput\"\n        type=\"file\"\n        accept=\"image/png, image/jpeg, image/jpg, image/gif, image/webp\"\n        hidden\n        @change=\"onFileChange\"\n      />\n      <div ref=\"editor\" />\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\">\n@import '@chatwoot/prosemirror-schema/src/styles/article.scss';\n\n.ProseMirror-menubar-wrapper {\n  display: flex;\n  flex-direction: column;\n\n  > .ProseMirror {\n    padding: 0;\n    word-break: break-word;\n  }\n}\n\n.editor-root {\n  position: relative;\n  width: 100%;\n}\n\n.ProseMirror-woot-style {\n  min-height: 5rem;\n  max-height: 7.5rem;\n  overflow: auto;\n}\n\n.ProseMirror-prompt {\n  @apply z-[9999] bg-n-alpha-3 min-w-80 backdrop-blur-[100px] border border-n-strong p-6 shadow-xl rounded-xl;\n\n  h5 {\n    @apply text-n-slate-12 mb-1.5;\n  }\n\n  .ProseMirror-prompt-buttons {\n    button {\n      @apply h-8 px-3;\n\n      &[type='submit'] {\n        @apply bg-n-brand text-white hover:bg-n-brand/90;\n      }\n\n      &[type='button'] {\n        @apply bg-n-slate-9/10 text-n-slate-12 hover:bg-n-slate-9/20;\n      }\n    }\n  }\n}\n</style>\n","<script setup>\nimport { computed, ref } from 'vue';\nimport { useI18n } from 'vue-i18n';\nimport { useRoute } from 'vue-router';\nimport { useStore } from 'dashboard/composables/store.js';\nimport { useAlert, useTrack } from 'dashboard/composables';\nimport { PORTALS_EVENTS } from 'dashboard/helper/AnalyticsHelper/events';\nimport { OnClickOutside } from '@vueuse/components';\nimport { getArticleStatus } from 'dashboard/helper/portalHelper.js';\nimport {\n  ARTICLE_EDITOR_STATUS_OPTIONS,\n  ARTICLE_STATUSES,\n  ARTICLE_MENU_ITEMS,\n} from 'dashboard/helper/portalHelper';\nimport wootConstants from 'dashboard/constants/globals';\n\nimport Button from 'dashboard/components-next/button/Button.vue';\nimport DropdownMenu from 'dashboard/components-next/dropdown-menu/DropdownMenu.vue';\n\nconst props = defineProps({\n  isUpdating: {\n    type: Boolean,\n    default: false,\n  },\n  isSaved: {\n    type: Boolean,\n    default: false,\n  },\n  status: {\n    type: String,\n    default: '',\n  },\n  articleId: {\n    type: Number,\n    default: 0,\n  },\n});\n\nconst emit = defineEmits(['goBack', 'previewArticle']);\n\nconst { t } = useI18n();\nconst store = useStore();\nconst route = useRoute();\n\nconst isArticlePublishing = ref(false);\n\nconst { ARTICLE_STATUS_TYPES } = wootConstants;\n\nconst showArticleActionMenu = ref(false);\n\nconst articleMenuItems = computed(() => {\n  const statusOptions = ARTICLE_EDITOR_STATUS_OPTIONS[props.status] ?? [];\n  return statusOptions.map(option => {\n    const { label, value, icon } = ARTICLE_MENU_ITEMS[option];\n    return {\n      label: t(label),\n      value,\n      action: 'update-status',\n      icon,\n    };\n  });\n});\n\nconst statusText = computed(() =>\n  t(\n    `HELP_CENTER.EDIT_ARTICLE_PAGE.HEADER.STATUS.${props.isUpdating ? 'SAVING' : 'SAVED'}`\n  )\n);\n\nconst onClickGoBack = () => emit('goBack');\n\nconst previewArticle = () => emit('previewArticle');\n\nconst getStatusMessage = (status, isSuccess) => {\n  const messageType = isSuccess ? 'SUCCESS' : 'ERROR';\n  const statusMap = {\n    [ARTICLE_STATUS_TYPES.PUBLISH]: 'PUBLISH_ARTICLE',\n    [ARTICLE_STATUS_TYPES.ARCHIVE]: 'ARCHIVE_ARTICLE',\n    [ARTICLE_STATUS_TYPES.DRAFT]: 'DRAFT_ARTICLE',\n  };\n\n  return statusMap[status]\n    ? t(`HELP_CENTER.${statusMap[status]}.API.${messageType}`)\n    : '';\n};\n\nconst updateArticleStatus = async ({ value }) => {\n  showArticleActionMenu.value = false;\n  const status = getArticleStatus(value);\n  if (status === ARTICLE_STATUS_TYPES.PUBLISH) {\n    isArticlePublishing.value = true;\n  }\n  const { portalSlug } = route.params;\n\n  try {\n    await store.dispatch('articles/update', {\n      portalSlug,\n      articleId: props.articleId,\n      status,\n    });\n\n    useAlert(getStatusMessage(status, true));\n\n    if (status === ARTICLE_STATUS_TYPES.ARCHIVE) {\n      useTrack(PORTALS_EVENTS.ARCHIVE_ARTICLE, { uiFrom: 'header' });\n    } else if (status === ARTICLE_STATUS_TYPES.PUBLISH) {\n      useTrack(PORTALS_EVENTS.PUBLISH_ARTICLE);\n    }\n    isArticlePublishing.value = false;\n  } catch (error) {\n    useAlert(error?.message ?? getStatusMessage(status, false));\n    isArticlePublishing.value = false;\n  }\n};\n</script>\n\n<template>\n  <div class=\"flex items-center justify-between h-20\">\n    <Button\n      :label=\"t('HELP_CENTER.EDIT_ARTICLE_PAGE.HEADER.BACK_TO_ARTICLES')\"\n      icon=\"i-lucide-chevron-left\"\n      variant=\"link\"\n      color=\"slate\"\n      size=\"sm\"\n      class=\"ltr:pl-3 rtl:pr-3\"\n      @click=\"onClickGoBack\"\n    />\n    <div class=\"flex items-center gap-4\">\n      <span\n        v-if=\"isUpdating || isSaved\"\n        class=\"text-xs font-medium transition-all duration-300 text-n-slate-11\"\n      >\n        {{ statusText }}\n      </span>\n      <div class=\"flex items-center gap-2\">\n        <Button\n          :label=\"t('HELP_CENTER.EDIT_ARTICLE_PAGE.HEADER.PREVIEW')\"\n          color=\"slate\"\n          size=\"sm\"\n          :disabled=\"!articleId\"\n          @click=\"previewArticle\"\n        />\n        <div class=\"flex items-center\">\n          <Button\n            :label=\"t('HELP_CENTER.EDIT_ARTICLE_PAGE.HEADER.PUBLISH')\"\n            size=\"sm\"\n            class=\"ltr:rounded-r-none rtl:rounded-l-none\"\n            :is-loading=\"isArticlePublishing\"\n            :disabled=\"\n              status === ARTICLE_STATUSES.PUBLISHED ||\n              !articleId ||\n              isArticlePublishing\n            \"\n            @click=\"updateArticleStatus({ value: ARTICLE_STATUSES.PUBLISHED })\"\n          />\n          <div class=\"relative\">\n            <OnClickOutside @trigger=\"showArticleActionMenu = false\">\n              <Button\n                icon=\"i-lucide-chevron-down\"\n                size=\"sm\"\n                :disabled=\"!articleId\"\n                class=\"ltr:rounded-l-none rtl:rounded-r-none\"\n                @click.stop=\"showArticleActionMenu = !showArticleActionMenu\"\n              />\n              <DropdownMenu\n                v-if=\"showArticleActionMenu\"\n                :menu-items=\"articleMenuItems\"\n                class=\"mt-2 ltr:right-0 rtl:left-0 top-full\"\n                @action=\"updateArticleStatus($event)\"\n              />\n            </OnClickOutside>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n","<script setup>\nimport { reactive, watch, onMounted } from 'vue';\nimport { useI18n } from 'vue-i18n';\nimport { debounce } from '@chatwoot/utils';\n\nimport InlineInput from 'dashboard/components-next/inline-input/InlineInput.vue';\nimport TextArea from 'dashboard/components-next/textarea/TextArea.vue';\nimport TagInput from 'dashboard/components-next/taginput/TagInput.vue';\nimport Button from 'dashboard/components-next/button/Button.vue';\n\nconst props = defineProps({\n  article: {\n    type: Object,\n    required: true,\n  },\n});\n\nconst emit = defineEmits(['saveArticle', 'close']);\n\nconst saveArticle = debounce(value => emit('saveArticle', value), 400, false);\n\nconst { t } = useI18n();\n\nconst state = reactive({\n  title: '',\n  description: '',\n  tags: [],\n});\n\nconst updateState = () => {\n  state.title = props.article.meta?.title || '';\n  state.description = props.article.meta?.description || '';\n  state.tags = props.article.meta?.tags || [];\n};\n\nwatch(\n  state,\n  newState => {\n    saveArticle({\n      title: newState.title,\n      description: newState.description,\n      tags: newState.tags,\n    });\n  },\n  { deep: true }\n);\n\nonMounted(() => {\n  updateState();\n});\n</script>\n\n<template>\n  <div\n    class=\"flex flex-col absolute w-[25rem] bg-n-alpha-3 outline outline-1 outline-n-container backdrop-blur-[100px] shadow-lg gap-6 rounded-xl p-6\"\n  >\n    <div class=\"flex items-center justify-between\">\n      <h3>\n        {{\n          t(\n            'HELP_CENTER.EDIT_ARTICLE_PAGE.ARTICLE_PROPERTIES.ARTICLE_PROPERTIES'\n          )\n        }}\n      </h3>\n      <Button\n        icon=\"i-lucide-x\"\n        size=\"sm\"\n        variant=\"ghost\"\n        color=\"slate\"\n        class=\"hover:text-n-slate-11\"\n        @click=\"emit('close')\"\n      />\n    </div>\n    <div class=\"flex flex-col gap-2\">\n      <div>\n        <div class=\"flex justify-between w-full gap-4 py-2\">\n          <label\n            class=\"text-sm font-medium whitespace-nowrap min-w-[6.25rem] text-n-slate-12\"\n          >\n            {{\n              t(\n                'HELP_CENTER.EDIT_ARTICLE_PAGE.ARTICLE_PROPERTIES.META_DESCRIPTION'\n              )\n            }}\n          </label>\n          <TextArea\n            v-model=\"state.description\"\n            :placeholder=\"\n              t(\n                'HELP_CENTER.EDIT_ARTICLE_PAGE.ARTICLE_PROPERTIES.META_DESCRIPTION_PLACEHOLDER'\n              )\n            \"\n            class=\"w-[13.75rem]\"\n            custom-text-area-wrapper-class=\"!p-0 !border-0 !rounded-none !bg-transparent transition-none\"\n            custom-text-area-class=\"max-h-[9.375rem]\"\n            auto-height\n            min-height=\"3rem\"\n          />\n        </div>\n        <div class=\"flex justify-between w-full gap-2 py-2\">\n          <InlineInput\n            v-model=\"state.title\"\n            :placeholder=\"\n              t(\n                'HELP_CENTER.EDIT_ARTICLE_PAGE.ARTICLE_PROPERTIES.META_TITLE_PLACEHOLDER'\n              )\n            \"\n            :label=\"\n              t('HELP_CENTER.EDIT_ARTICLE_PAGE.ARTICLE_PROPERTIES.META_TITLE')\n            \"\n            custom-label-class=\"min-w-[7.5rem]\"\n          />\n        </div>\n        <div class=\"flex justify-between w-full gap-3 py-2\">\n          <label\n            class=\"text-sm font-medium whitespace-nowrap min-w-[7.5rem] text-n-slate-12\"\n          >\n            {{\n              t('HELP_CENTER.EDIT_ARTICLE_PAGE.ARTICLE_PROPERTIES.META_TAGS')\n            }}\n          </label>\n          <TagInput\n            v-model=\"state.tags\"\n            :placeholder=\"\n              t(\n                'HELP_CENTER.EDIT_ARTICLE_PAGE.ARTICLE_PROPERTIES.META_TAGS_PLACEHOLDER'\n              )\n            \"\n            class=\"w-[14rem]\"\n          />\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n","<script setup>\nimport { computed, ref, onMounted } from 'vue';\nimport { useI18n } from 'vue-i18n';\nimport { useRoute } from 'vue-router';\nimport { OnClickOutside } from '@vueuse/components';\nimport { useMapGetter } from 'dashboard/composables/store';\n\nimport Button from 'dashboard/components-next/button/Button.vue';\nimport Avatar from 'dashboard/components-next/avatar/Avatar.vue';\nimport DropdownMenu from 'dashboard/components-next/dropdown-menu/DropdownMenu.vue';\nimport ArticleEditorProperties from 'dashboard/components-next/HelpCenter/Pages/ArticleEditorPage/ArticleEditorProperties.vue';\n\nconst props = defineProps({\n  article: {\n    type: Object,\n    default: () => ({}),\n  },\n});\n\nconst emit = defineEmits(['saveArticle', 'setAuthor', 'setCategory']);\n\nconst { t } = useI18n();\nconst route = useRoute();\n\nconst openAgentsList = ref(false);\nconst openCategoryList = ref(false);\nconst openProperties = ref(false);\nconst selectedAuthorId = ref(null);\nconst selectedCategoryId = ref(null);\n\nconst agents = useMapGetter('agents/getAgents');\nconst categories = useMapGetter('categories/allCategories');\nconst currentUserId = useMapGetter('getCurrentUserID');\n\nconst isNewArticle = computed(() => !props.article?.id);\n\nconst currentUser = computed(() =>\n  agents.value.find(agent => agent.id === currentUserId.value)\n);\n\nconst categorySlugFromRoute = computed(() => route.params.categorySlug);\n\nconst author = computed(() => {\n  if (isNewArticle.value) {\n    return selectedAuthorId.value\n      ? agents.value.find(agent => agent.id === selectedAuthorId.value)\n      : currentUser.value;\n  }\n  return props.article?.author || null;\n});\n\nconst authorName = computed(\n  () => author.value?.name || author.value?.available_name || ''\n);\nconst authorThumbnailSrc = computed(() => author.value?.thumbnail);\n\nconst agentList = computed(() => {\n  return (\n    agents.value\n      ?.map(({ name, id, thumbnail }) => ({\n        label: name,\n        value: id,\n        thumbnail: { name, src: thumbnail },\n        isSelected: props.article?.author?.id\n          ? id === props.article.author.id\n          : id === (selectedAuthorId.value || currentUserId.value),\n        action: 'assignAuthor',\n      }))\n      // Sort the list by isSelected first, then by name(label)\n      .toSorted((a, b) => {\n        if (a.isSelected !== b.isSelected) {\n          return Number(b.isSelected) - Number(a.isSelected);\n        }\n        return a.label.localeCompare(b.label);\n      }) ?? []\n  );\n});\n\nconst hasAgentList = computed(() => {\n  return agents.value?.length > 1;\n});\n\nconst findCategoryFromSlug = slug => {\n  return categories.value?.find(category => category.slug === slug);\n};\n\nconst assignCategoryFromSlug = slug => {\n  const categoryFromSlug = findCategoryFromSlug(slug);\n  if (categoryFromSlug) {\n    selectedCategoryId.value = categoryFromSlug.id;\n    return categoryFromSlug;\n  }\n  return null;\n};\n\nconst selectedCategory = computed(() => {\n  if (isNewArticle.value) {\n    if (categorySlugFromRoute.value) {\n      const categoryFromSlug = assignCategoryFromSlug(\n        categorySlugFromRoute.value\n      );\n      if (categoryFromSlug) return categoryFromSlug;\n    }\n    return selectedCategoryId.value\n      ? categories.value.find(\n          category => category.id === selectedCategoryId.value\n        )\n      : categories.value[0] || null;\n  }\n  return categories.value.find(\n    category => category.id === props.article?.category?.id\n  );\n});\n\nconst categoryList = computed(() => {\n  return (\n    categories.value\n      .map(({ name, id, icon }) => ({\n        label: name,\n        value: id,\n        emoji: icon,\n        isSelected: isNewArticle.value\n          ? id === (selectedCategoryId.value || selectedCategory.value?.id)\n          : id === props.article?.category?.id,\n        action: 'assignCategory',\n      }))\n      // Sort categories by isSelected\n      .toSorted((a, b) => Number(b.isSelected) - Number(a.isSelected))\n  );\n});\n\nconst hasCategoryMenuItems = computed(() => {\n  return categoryList.value?.length > 0;\n});\n\nconst handleArticleAction = ({ action, value }) => {\n  const actions = {\n    assignAuthor: () => {\n      if (isNewArticle.value) {\n        selectedAuthorId.value = value;\n        emit('setAuthor', value);\n      } else {\n        emit('saveArticle', { author_id: value });\n      }\n      openAgentsList.value = false;\n    },\n    assignCategory: () => {\n      if (isNewArticle.value) {\n        selectedCategoryId.value = value;\n        emit('setCategory', value);\n      } else {\n        emit('saveArticle', { category_id: value });\n      }\n      openCategoryList.value = false;\n    },\n  };\n\n  actions[action]?.();\n};\n\nconst updateMeta = meta => {\n  emit('saveArticle', { meta });\n};\n\nonMounted(() => {\n  if (categorySlugFromRoute.value && isNewArticle.value) {\n    // Assign category from slug if there is one\n    const categoryFromSlug = findCategoryFromSlug(categorySlugFromRoute.value);\n    if (categoryFromSlug) {\n      handleArticleAction({\n        action: 'assignCategory',\n        value: categoryFromSlug?.id,\n      });\n    }\n  }\n});\n</script>\n\n<template>\n  <div class=\"flex items-center gap-4\">\n    <div class=\"relative flex items-center gap-2\">\n      <OnClickOutside @trigger=\"openAgentsList = false\">\n        <Button\n          variant=\"ghost\"\n          color=\"slate\"\n          class=\"!px-0 font-normal hover:!bg-transparent\"\n          text-variant=\"info\"\n          @click=\"openAgentsList = !openAgentsList\"\n        >\n          <Avatar\n            :name=\"authorName\"\n            :src=\"authorThumbnailSrc\"\n            :size=\"20\"\n            rounded-full\n          />\n          <span class=\"text-sm text-n-slate-12 hover:text-n-slate-11\">\n            {{ authorName || '-' }}\n          </span>\n        </Button>\n        <DropdownMenu\n          v-if=\"openAgentsList && hasAgentList\"\n          :menu-items=\"agentList\"\n          show-search\n          class=\"z-[100] w-48 mt-2 overflow-y-auto ltr:left-0 rtl:right-0 top-full max-h-60\"\n          @action=\"handleArticleAction\"\n        />\n      </OnClickOutside>\n    </div>\n    <div class=\"w-px h-3 bg-n-weak\" />\n    <div class=\"relative\">\n      <OnClickOutside @trigger=\"openCategoryList = false\">\n        <Button\n          :label=\"\n            selectedCategory?.name ||\n            t('HELP_CENTER.EDIT_ARTICLE_PAGE.EDIT_ARTICLE.UNCATEGORIZED')\n          \"\n          :icon=\"!selectedCategory?.icon ? 'i-lucide-shapes' : ''\"\n          variant=\"ghost\"\n          color=\"slate\"\n          class=\"!px-2 font-normal hover:!bg-transparent\"\n          @click=\"openCategoryList = !openCategoryList\"\n        >\n          <span\n            v-if=\"selectedCategory\"\n            class=\"text-sm text-n-slate-12 hover:text-n-slate-11\"\n          >\n            {{\n              `${selectedCategory.icon || ''} ${selectedCategory.name || t('HELP_CENTER.EDIT_ARTICLE_PAGE.EDIT_ARTICLE.UNCATEGORIZED')}`\n            }}\n          </span>\n        </Button>\n        <DropdownMenu\n          v-if=\"openCategoryList && hasCategoryMenuItems\"\n          :menu-items=\"categoryList\"\n          show-search\n          class=\"w-48 mt-2 z-[100] overflow-y-auto left-0 top-full max-h-60\"\n          @action=\"handleArticleAction\"\n        />\n      </OnClickOutside>\n    </div>\n\n    <div class=\"w-px h-3 bg-n-weak\" />\n    <div class=\"relative\">\n      <OnClickOutside @trigger=\"openProperties = false\">\n        <Button\n          :label=\"\n            t('HELP_CENTER.EDIT_ARTICLE_PAGE.EDIT_ARTICLE.MORE_PROPERTIES')\n          \"\n          icon=\"i-lucide-plus\"\n          variant=\"ghost\"\n          color=\"slate\"\n          :disabled=\"isNewArticle\"\n          class=\"!px-2 font-normal hover:!bg-transparent hover:!text-n-slate-11\"\n          @click=\"openProperties = !openProperties\"\n        />\n        <ArticleEditorProperties\n          v-if=\"openProperties\"\n          :article=\"article\"\n          class=\"right-0 z-[100] mt-2 xl:left-0 top-full\"\n          @save-article=\"updateMeta\"\n          @close=\"openProperties = false\"\n        />\n      </OnClickOutside>\n    </div>\n  </div>\n</template>\n","<script setup>\nimport { computed } from 'vue';\nimport { debounce } from '@chatwoot/utils';\nimport { useI18n } from 'vue-i18n';\nimport { ARTICLE_EDITOR_MENU_OPTIONS } from 'dashboard/constants/editor';\n\nimport HelpCenterLayout from 'dashboard/components-next/HelpCenter/HelpCenterLayout.vue';\nimport TextArea from 'dashboard/components-next/textarea/TextArea.vue';\nimport FullEditor from 'dashboard/components/widgets/WootWriter/FullEditor.vue';\nimport ArticleEditorHeader from 'dashboard/components-next/HelpCenter/Pages/ArticleEditorPage/ArticleEditorHeader.vue';\nimport ArticleEditorControls from 'dashboard/components-next/HelpCenter/Pages/ArticleEditorPage/ArticleEditorControls.vue';\n\nconst props = defineProps({\n  article: {\n    type: Object,\n    default: () => ({}),\n  },\n  isUpdating: {\n    type: Boolean,\n    default: false,\n  },\n  isSaved: {\n    type: Boolean,\n    default: false,\n  },\n});\n\nconst emit = defineEmits([\n  'saveArticle',\n  'saveArticleAsync',\n  'goBack',\n  'setAuthor',\n  'setCategory',\n  'previewArticle',\n]);\n\nconst { t } = useI18n();\n\nconst isNewArticle = computed(() => !props.article?.id);\n\nconst saveAndSync = value => {\n  emit('saveArticle', value);\n};\n\n// this will only send the data to the backend\n// but will not update the local state preventing unnecessary re-renders\n// since the data is already saved and we keep the editor text as the source of truth\nconst quickSave = debounce(\n  value => emit('saveArticleAsync', value),\n  400,\n  false\n);\n\n// 2.5 seconds is enough to know that the user has stopped typing and is taking a pause\n// so we can save the data to the backend and retrieve the updated data\n// this will update the local state with response data\n// Only use to save for existing articles\nconst saveAndSyncDebounced = debounce(saveAndSync, 2500, false);\n\n// Debounced save for new articles\nconst quickSaveNewArticle = debounce(saveAndSync, 400, false);\n\nconst handleSave = value => {\n  if (isNewArticle.value) {\n    quickSaveNewArticle(value);\n  } else {\n    quickSave(value);\n    saveAndSyncDebounced(value);\n  }\n};\n\nconst articleTitle = computed({\n  get: () => props.article.title,\n  set: value => {\n    handleSave({ title: value });\n  },\n});\n\nconst articleContent = computed({\n  get: () => props.article.content,\n  set: content => {\n    handleSave({ content });\n  },\n});\n\nconst onClickGoBack = () => {\n  emit('goBack');\n};\n\nconst setAuthorId = authorId => {\n  emit('setAuthor', authorId);\n};\n\nconst setCategoryId = categoryId => {\n  emit('setCategory', categoryId);\n};\n\nconst previewArticle = () => {\n  emit('previewArticle');\n};\n</script>\n\n<template>\n  <HelpCenterLayout :show-header-title=\"false\" :show-pagination-footer=\"false\">\n    <template #header-actions>\n      <ArticleEditorHeader\n        :is-updating=\"isUpdating\"\n        :is-saved=\"isSaved\"\n        :status=\"article.status\"\n        :article-id=\"article.id\"\n        @go-back=\"onClickGoBack\"\n        @preview-article=\"previewArticle\"\n      />\n    </template>\n    <template #content>\n      <div class=\"flex flex-col gap-3 pl-4 mb-3 rtl:pr-3 rtl:pl-0\">\n        <TextArea\n          v-model=\"articleTitle\"\n          auto-height\n          min-height=\"4rem\"\n          custom-text-area-class=\"!text-[32px] !leading-[48px] !font-medium !tracking-[0.2px]\"\n          custom-text-area-wrapper-class=\"border-0 !bg-transparent dark:!bg-transparent !py-0 !px-0\"\n          placeholder=\"Title\"\n          autofocus\n        />\n        <ArticleEditorControls\n          :article=\"article\"\n          @save-article=\"saveAndSync\"\n          @set-author=\"setAuthorId\"\n          @set-category=\"setCategoryId\"\n        />\n      </div>\n      <FullEditor\n        v-model=\"articleContent\"\n        class=\"py-0 pb-10 pl-4 rtl:pr-4 rtl:pl-0 h-fit\"\n        :placeholder=\"\n          t('HELP_CENTER.EDIT_ARTICLE_PAGE.EDIT_ARTICLE.EDITOR_PLACEHOLDER')\n        \"\n        :enabled-menu-options=\"ARTICLE_EDITOR_MENU_OPTIONS\"\n        :autofocus=\"false\"\n      />\n    </template>\n  </HelpCenterLayout>\n</template>\n\n<style lang=\"scss\" scoped>\n::v-deep {\n  .ProseMirror .empty-node::before {\n    @apply text-n-slate-10 text-base;\n  }\n\n  .ProseMirror-menubar-wrapper {\n    .ProseMirror-woot-style {\n      @apply min-h-[15rem] max-h-full;\n    }\n  }\n\n  .ProseMirror-menubar {\n    display: none; // Hide by default\n  }\n\n  .editor-root .has-selection {\n    .ProseMirror-menubar {\n      @apply h-8 rounded-lg !px-2 z-50 bg-n-solid-3 items-center gap-4 ml-0 mb-0 shadow-md outline outline-1 outline-n-weak;\n      display: flex;\n      top: var(--selection-top, auto) !important;\n      left: var(--selection-left, 0) !important;\n      width: fit-content !important;\n      position: absolute !important;\n\n      .ProseMirror-menuitem {\n        @apply mr-0;\n\n        .ProseMirror-icon {\n          @apply p-0 mt-1 !mr-0;\n\n          svg {\n            width: 20px !important;\n            height: 20px !important;\n          }\n        }\n      }\n\n      .ProseMirror-menu-active {\n        @apply bg-n-slate-3;\n      }\n    }\n  }\n}\n</style>\n"],"names":["replaceImage","currentUrl","newUrl","view","node","pos","tr","imagePastePlugin","uploadImage","Plugin","event","slice","imageUrls","url","error","MAXIMUM_FILE_UPLOAD_SIZE","createState","content","placeholder","plugins","methods","enabledMenuOptions","EditorState","ArticleMarkdownTransformer","fullSchema","buildEditor","editorView","state","_sfc_main","keyboardEventListenerMixins","uiSettings","updateUISettings","useUISettings","newValue","ArticleMarkdownSerializer","useAlert","file","checkFileSizeLimit","fileUrl","selection","from","paragraphNode","EditorView","tx","data","Selection","editorState","to","hasSelection","editor","editorLeft","editorTop","editorWidth","menubarWidth","endBottom","endRight","startLeft","top","left","_hoisted_1","_hoisted_2","_createElementBlock","_createElementVNode","$options","args","props","__props","emit","__emit","t","useI18n","store","useStore","route","useRoute","isArticlePublishing","ref","ARTICLE_STATUS_TYPES","wootConstants","showArticleActionMenu","articleMenuItems","computed","ARTICLE_EDITOR_STATUS_OPTIONS","option","label","value","icon","ARTICLE_MENU_ITEMS","statusText","onClickGoBack","previewArticle","getStatusMessage","status","isSuccess","messageType","statusMap","updateArticleStatus","getArticleStatus","portalSlug","useTrack","PORTALS_EVENTS","saveArticle","debounce","reactive","updateState","_a","_b","_c","watch","newState","onMounted","openAgentsList","openCategoryList","openProperties","selectedAuthorId","selectedCategoryId","agents","useMapGetter","categories","currentUserId","isNewArticle","currentUser","agent","categorySlugFromRoute","author","authorName","authorThumbnailSrc","agentList","name","id","thumbnail","a","b","hasAgentList","findCategoryFromSlug","slug","category","assignCategoryFromSlug","categoryFromSlug","selectedCategory","categoryList","hasCategoryMenuItems","handleArticleAction","action","actions","updateMeta","meta","saveAndSync","quickSave","saveAndSyncDebounced","quickSaveNewArticle","handleSave","articleTitle","articleContent","setAuthorId","authorId","setCategoryId","categoryId"],"mappings":"2xBASA,SAASA,GAAaC,EAAYC,EAAQC,EAAM,CAC9CA,EAAK,MAAM,IAAI,YAAY,CAACC,EAAMC,IAAQ,CACxC,GAAID,EAAK,KAAK,OAAS,SAAWA,EAAK,MAAM,MAAQH,EAAY,CAC/D,MAAMK,EAAKH,EAAK,MAAM,GAAG,cAAcE,EAAK,KAAM,CAChD,GAAGD,EAAK,MACR,IAAKF,CACb,CAAO,EACDC,EAAK,SAASG,CAAE,CAClB,CACF,CAAC,CACH,CASA,MAAMC,GAAoBC,GACxB,IAAIC,GAAO,CACT,MAAO,CAQL,YAAYN,EAAMO,EAAOC,EAAO,CAC9B,MAAMC,EAAY,CAAA,EAClBD,EAAM,QAAQ,YAAaP,GAAS,CAC9BA,EAAK,KAAK,OAAS,SACrBQ,EAAU,KAAKR,EAAK,MAAM,GAAG,CAEjC,CAAC,EACD,QAAQ,IAAIQ,EAAU,IAAI,MAAOC,GAAQ,CACvC,GAAI,CACF,MAAMX,EAAS,MAAMM,EAAYK,CAAG,EACpCb,GAAaa,EAAKX,EAAQC,CAAI,CAChC,OAASW,EAAO,CACd,QAAQ,MAAM,yBAA0BA,CAAK,CAC/C,CACF,CAAC,CAAC,CACJ,CACN,CACA,CAAG,ECvCGC,GAA2B,EAC3BC,GAAc,CAClBC,EACAC,EAEAC,EAAU,CAAA,EAEVC,EAAU,CAAA,EACVC,IAEOC,GAAY,OAAO,CACxB,IAAK,IAAIC,GAA2BC,CAAU,EAAE,MAAMP,CAAO,EAC7D,QAASQ,GAAY,CACnB,OAAQD,EACR,YAAAN,EACA,QAAAE,EACA,QAAAD,EACA,mBAAAE,CACF,CAAC,CACH,CAAC,EAGH,IAAIK,EAAa,KACbC,EAEJ,MAAKC,GAAU,CACb,OAAQ,CAACC,EAA2B,EACpC,MAAO,CACL,WAAY,CAAE,KAAM,OAAQ,QAAS,IACrC,SAAU,CAAE,KAAM,OAAQ,QAAS,IACnC,YAAa,CAAE,KAAM,OAAQ,QAAS,IACtC,mBAAoB,CAAE,KAAM,MAAO,QAAS,IAAM,CAAA,GAClD,UAAW,CACT,KAAM,QACN,QAAS,KAGb,MAAO,CAAC,OAAQ,QAAS,oBAAqB,QAAS,QAAS,SAAS,EACzE,OAAQ,CACN,KAAM,CAAE,WAAAC,EAAY,iBAAAC,CAAe,EAAMC,GAAa,EAEtD,MAAO,CACL,WAAAF,EACA,iBAAAC,EAEJ,EACA,MAAO,CACL,MAAO,CACL,QAAS,CAACxB,GAAiB,KAAK,iBAAiB,CAAC,EAClD,eAAgB,GAEpB,EACA,MAAO,CACL,WAAW0B,EAAW,GAAI,CACpBA,IAAa,KAAK,qBACpB,KAAK,YAAW,CAEpB,EACA,UAAW,CACT,KAAK,YAAW,CAClB,GAGF,SAAU,CACRN,EAAQX,GACN,KAAK,WACL,KAAK,YACL,KAAK,QACL,CAAE,cAAe,KAAK,iBACtB,KAAK,mBAET,EACA,SAAU,CACR,KAAK,iBAAgB,EAErBU,EAAW,YAAYC,CAAK,EACxB,KAAK,WACP,KAAK,sBAAqB,CAE9B,EACA,QAAS,CACP,mBAAoB,CAClB,OAAID,EACKQ,GAA0B,UAAUR,EAAW,MAAM,GAAG,EAE1D,EACT,EACA,iBAAkB,CAChB,KAAK,MAAM,iBAAiB,MAAK,CACnC,EACA,MAAM,kBAAkBb,EAAK,CAC3B,GAAI,CASF,OARgB,MAAM,KAAK,OAAO,SAChC,+BACA,CACE,WAAY,KAAK,OAAO,OAAO,WAC/B,IAAAA,CACF,EAIJ,MAAgB,CACd,OAAAsB,EACE,KAAK,GAAG,6DAA6D,GAEhE,EACT,CACF,EACA,cAAe,CACb,MAAMC,EAAO,KAAK,MAAM,iBAAiB,MAAM,CAAC,EAE5CC,GAAmBD,EAAMrB,EAAwB,EACnD,KAAK,qBAAqBqB,CAAI,EAE9BD,EACE,KAAK,GAAG,0DAA2D,CACjE,KAAMpB,GACP,GAIL,KAAK,MAAM,iBAAiB,MAAQ,EACtC,EACA,MAAM,qBAAqBqB,EAAM,CAC/B,GAAI,CACF,MAAME,EAAU,MAAM,KAAK,OAAO,SAAS,uBAAwB,CACjE,WAAY,KAAK,OAAO,OAAO,WAC/B,KAAAF,CACF,CAAC,EAEGE,GACF,KAAK,mBAAmBA,CAAO,CAEnC,MAAgB,CACdH,EAAS,KAAK,GAAG,+CAA+C,CAAC,CACnE,CACF,EACA,mBAAmBG,EAAS,CAC1B,KAAM,CAAE,UAAAC,GAAcb,EAAW,MAC3Bc,EAAOD,EAAU,KACjBnC,EAAOsB,EAAW,MAAM,OAAO,MAAM,MAAM,OAAO,CACtD,IAAKY,CACP,CAAC,EACKG,EAAgBf,EAAW,MAAM,OAAO,KAAK,WAAW,EAC9D,GAAItB,EAAM,CAER,MAAME,EAAKoB,EAAW,MAAM,GACzB,qBAAqBe,CAAa,EAClC,OAAOD,EAAO,EAAGpC,CAAI,EAExBsB,EAAW,SAASpB,EAAG,gBAAgB,EACvC,KAAK,sBAAqB,CAC5B,CACF,EACA,aAAc,CACZqB,EAAQX,GACN,KAAK,WACL,KAAK,YACL,KAAK,QACL,CAAE,cAAe,KAAK,iBACtB,KAAK,oBAEPU,EAAW,YAAYC,CAAK,EAC5B,KAAK,sBAAqB,CAC5B,EACA,kBAAmB,CACjBD,EAAa,IAAIgB,GAAW,KAAK,MAAM,OAAQ,CAC7C,MAAOf,EACP,oBAAqBgB,GAAM,CACzBhB,EAAQA,EAAM,MAAMgB,CAAE,EACtBjB,EAAW,YAAYC,CAAK,EACxBgB,EAAG,YACL,KAAK,aAAY,EAEnB,KAAK,eAAehB,CAAK,CAC3B,EACA,gBAAiB,CACf,MAAO,KAAK,QACZ,MAAO,KAAK,QACZ,KAAM,KAAK,OACX,QAAS,KAAK,UACd,MAAO,CAACxB,EAAMO,IAAU,CACtB,MAAMkC,EAAOlC,EAAM,cAAc,MAC7BkC,EAAK,OAAS,IAChBA,EAAK,QAAQR,GAAQ,CAEfA,EAAK,KAAK,SAAS,OAAO,GAC5B,KAAK,qBAAqBA,CAAI,CAElC,CAAC,EACD1B,EAAM,eAAc,EAExB,EAEJ,CAAC,CACH,EACA,iBAAkB,CAAC,EACnB,uBAAwB,CACtB,KAAM,CAAE,GAAAJ,GAAOoB,EAAW,MACpBa,EAAYM,GAAU,MAAMvC,EAAG,GAAG,EAExCoB,EAAW,SAASpB,EAAG,aAAaiC,CAAS,CAAC,EAC9Cb,EAAW,MAAK,CAClB,EACA,cAAe,CACb,KAAK,MAAM,oBAAqB,KAAK,kBAAiB,CAAE,EACxD,KAAK,MAAM,QAAS,KAAK,kBAAiB,CAAE,CAC9C,EACA,SAAU,CACR,KAAK,MAAM,OAAO,CACpB,EACA,WAAY,CACV,KAAK,MAAM,SAAS,CACtB,EACA,QAAS,CACP,KAAK,MAAM,MAAM,CACnB,EACA,SAAU,CACR,KAAK,MAAM,OAAO,CACpB,EACA,eAAeoB,EAAa,CAC1B,KAAM,CAAE,KAAAN,EAAM,GAAAO,CAAC,EAAMD,EAAY,UAE3BE,EAAeR,IAASO,EAE9B,GAAIC,IAAiB,KAAK,eAAgB,OAE1C,KAAK,eAAiBA,EAEtB,KAAM,CAAE,OAAAC,GAAW,KAAK,MAGxBA,EAAO,UAAU,OAAO,gBAAiBD,CAAY,EAEjDA,GAAc,KAAK,mBAAmBF,CAAW,CACvD,EACA,mBAAmBA,EAAa,CAC9B,GAAI,CAACA,EAAY,UAAW,OAG5B,KAAM,CAAE,KAAAN,EAAM,GAAAO,CAAC,EAAMD,EAAY,UAC3B,CAAE,OAAAG,GAAW,KAAK,MAElB,CAAE,KAAMC,EAAY,IAAKC,GAC7BF,EAAO,sBAAqB,EAGxBG,EAAcH,EAAO,YACrBI,EAAe,IAGf,CAAE,OAAQC,EAAW,MAAOC,CAAO,EAAM7B,EAAW,YAAYqB,CAAE,EAElE,CAAE,KAAMS,CAAQ,EAAM9B,EAAW,YAAYc,CAAI,EAGjDiB,EAAMH,EAAYH,EAAY,GAG9BO,EAAO,KAAK,IAChB,EACA,KAAK,KACFF,EAAYD,GAAY,EAAIL,EAC7BE,EAAcC,CAChB,GAGFJ,EAAO,MAAM,YAAY,kBAAmB,GAAGQ,CAAG,IAAI,EACtDR,EAAO,MAAM,YAAY,mBAAoB,GAAGS,CAAI,IAAI,CAC1D,EAEJ,EAKSC,GAAA,CAAA,MAAM,6BAA6B,EAQjCC,GAAA,CAAA,IAAI,QAAQ,sCATrBC,EAWM,MAAA,KAAA,CAVJC,EASM,MATNH,GASM,CARJG,EAME,QAAA,CALA,IAAI,mBACJ,KAAK,OACL,OAAO,0DACP,OAAA,GACC,6BAAQC,EAAA,cAAAA,EAAA,aAAA,GAAAC,CAAA,cAEXF,EAAoB,MAApBF,GAAoB,KAAA,GAAA,khBCzR1B,MAAMK,EAAQC,EAmBRC,EAAOC,EAEP,CAAE,EAAAC,CAAC,EAAKC,EAAO,EACfC,EAAQC,GAAQ,EAChBC,EAAQC,GAAQ,EAEhBC,EAAsBC,EAAI,EAAK,EAE/B,CAAE,qBAAAC,CAAoB,EAAKC,GAE3BC,EAAwBH,EAAI,EAAK,EAEjCI,EAAmBC,EAAS,KACVC,GAA8BjB,EAAM,MAAM,GAAK,CAAA,GAChD,IAAIkB,GAAU,CACjC,KAAM,CAAE,MAAAC,EAAO,MAAAC,EAAO,KAAAC,CAAI,EAAKC,GAAmBJ,CAAM,EACxD,MAAO,CACL,MAAOd,EAAEe,CAAK,EACd,MAAAC,EACA,OAAQ,gBACR,KAAAC,CACN,CACE,CAAC,CACF,EAEKE,EAAaP,EAAS,IAC1BZ,EACE,+CAA+CJ,EAAM,WAAa,SAAW,OAAO,EACxF,CACA,EAEMwB,EAAgB,IAAMtB,EAAK,QAAQ,EAEnCuB,EAAiB,IAAMvB,EAAK,gBAAgB,EAE5CwB,EAAmB,CAACC,EAAQC,IAAc,CAC9C,MAAMC,EAAcD,EAAY,UAAY,QACtCE,EAAY,CAChB,CAAClB,EAAqB,OAAO,EAAG,kBAChC,CAACA,EAAqB,OAAO,EAAG,kBAChC,CAACA,EAAqB,KAAK,EAAG,eAClC,EAEE,OAAOkB,EAAUH,CAAM,EACnBvB,EAAE,eAAe0B,EAAUH,CAAM,CAAC,QAAQE,CAAW,EAAE,EACvD,EACN,EAEME,EAAsB,MAAO,CAAE,MAAAX,KAAY,CAC/CN,EAAsB,MAAQ,GAC9B,MAAMa,EAASK,GAAiBZ,CAAK,EACjCO,IAAWf,EAAqB,UAClCF,EAAoB,MAAQ,IAE9B,KAAM,CAAE,WAAAuB,GAAezB,EAAM,OAE7B,GAAI,CACF,MAAMF,EAAM,SAAS,kBAAmB,CACtC,WAAA2B,EACA,UAAWjC,EAAM,UACjB,OAAA2B,CACN,CAAK,EAEDzD,EAASwD,EAAiBC,EAAQ,EAAI,CAAC,EAEnCA,IAAWf,EAAqB,QAClCsB,EAASC,GAAe,gBAAiB,CAAE,OAAQ,QAAQ,CAAE,EACpDR,IAAWf,EAAqB,SACzCsB,EAASC,GAAe,eAAe,EAEzCzB,EAAoB,MAAQ,EAC9B,OAAS7D,EAAO,CACdqB,GAASrB,GAAA,YAAAA,EAAO,UAAW6E,EAAiBC,EAAQ,EAAK,CAAC,EAC1DjB,EAAoB,MAAQ,EAC9B,CACF,81DCvGA,MAAMV,EAAQC,EAORC,EAAOC,EAEPiC,EAAcC,EAASjB,GAASlB,EAAK,cAAekB,CAAK,EAAG,IAAK,EAAK,EAEtE,CAAE,EAAAhB,CAAC,EAAKC,EAAO,EAEf3C,EAAQ4E,GAAS,CACrB,MAAO,GACP,YAAa,GACb,KAAM,CAAA,CACR,CAAC,EAEKC,EAAc,IAAM,WACxB7E,EAAM,QAAQ8E,EAAAxC,EAAM,QAAQ,OAAd,YAAAwC,EAAoB,QAAS,GAC3C9E,EAAM,cAAc+E,EAAAzC,EAAM,QAAQ,OAAd,YAAAyC,EAAoB,cAAe,GACvD/E,EAAM,OAAOgF,EAAA1C,EAAM,QAAQ,OAAd,YAAA0C,EAAoB,OAAQ,CAAA,CAC3C,EAEA,OAAAC,GACEjF,EACAkF,GAAY,CACVR,EAAY,CACV,MAAOQ,EAAS,MAChB,YAAaA,EAAS,YACtB,KAAMA,EAAS,IACrB,CAAK,CACH,EACA,CAAE,KAAM,EAAI,CACd,EAEAC,GAAU,IAAM,CACdN,EAAW,CACb,CAAC,u1DCrCD,MAAMvC,EAAQC,EAORC,EAAOC,EAEP,CAAE,EAAAC,CAAC,EAAKC,EAAO,EACfG,EAAQC,GAAQ,EAEhBqC,EAAiBnC,EAAI,EAAK,EAC1BoC,EAAmBpC,EAAI,EAAK,EAC5BqC,EAAiBrC,EAAI,EAAK,EAC1BsC,EAAmBtC,EAAI,IAAI,EAC3BuC,EAAqBvC,EAAI,IAAI,EAE7BwC,EAASC,EAAa,kBAAkB,EACxCC,EAAaD,EAAa,0BAA0B,EACpDE,EAAgBF,EAAa,kBAAkB,EAE/CG,EAAevC,EAAS,IAAA,OAAM,SAACwB,EAAAxC,EAAM,UAAN,MAAAwC,EAAe,IAAE,EAEhDgB,EAAcxC,EAAS,IAC3BmC,EAAO,MAAM,KAAKM,GAASA,EAAM,KAAOH,EAAc,KAAK,CAC7D,EAEMI,EAAwB1C,EAAS,IAAMR,EAAM,OAAO,YAAY,EAEhEmD,EAAS3C,EAAS,IAAM,OAC5B,OAAIuC,EAAa,MACRN,EAAiB,MACpBE,EAAO,MAAM,KAAKM,GAASA,EAAM,KAAOR,EAAiB,KAAK,EAC9DO,EAAY,QAEXhB,EAAAxC,EAAM,UAAN,YAAAwC,EAAe,SAAU,IAClC,CAAC,EAEKoB,EAAa5C,EACjB,IAAA,SAAM,QAAAwB,EAAAmB,EAAO,QAAP,YAAAnB,EAAc,SAAQC,EAAAkB,EAAO,QAAP,YAAAlB,EAAc,iBAAkB,GAC9D,EACMoB,EAAqB7C,EAAS,IAAA,OAAM,OAAAwB,EAAAmB,EAAO,QAAP,YAAAnB,EAAc,UAAS,EAE3DsB,EAAY9C,EAAS,IAAM,OAC/B,QACEwB,EAAAW,EAAO,QAAP,YAAAX,EACI,IAAI,CAAC,CAAE,KAAAuB,EAAM,GAAAC,EAAI,UAAAC,CAAS,IAAE,SAAM,OAClC,MAAOF,EACP,MAAOC,EACP,UAAW,CAAE,KAAAD,EAAM,IAAKE,CAAS,EACjC,YAAYxB,GAAAD,EAAAxC,EAAM,UAAN,YAAAwC,EAAe,SAAf,MAAAC,EAAuB,GAC/BuB,IAAOhE,EAAM,QAAQ,OAAO,GAC5BgE,KAAQf,EAAiB,OAASK,EAAc,OACpD,OAAQ,cAChB,IAEO,SAAS,CAACY,EAAGC,IACRD,EAAE,aAAeC,EAAE,WACd,OAAOA,EAAE,UAAU,EAAI,OAAOD,EAAE,UAAU,EAE5CA,EAAE,MAAM,cAAcC,EAAE,KAAK,KAChC,CAAA,CAEZ,CAAC,EAEKC,GAAepD,EAAS,IAAM,OAClC,QAAOwB,EAAAW,EAAO,QAAP,YAAAX,EAAc,QAAS,CAChC,CAAC,EAEK6B,EAAuBC,GAAQ,OACnC,OAAO9B,EAAAa,EAAW,QAAX,YAAAb,EAAkB,KAAK+B,GAAYA,EAAS,OAASD,EAC9D,EAEME,GAAyBF,GAAQ,CACrC,MAAMG,EAAmBJ,EAAqBC,CAAI,EAClD,OAAIG,GACFvB,EAAmB,MAAQuB,EAAiB,GACrCA,GAEF,IACT,EAEMC,EAAmB1D,EAAS,IAAM,CACtC,GAAIuC,EAAa,MAAO,CACtB,GAAIG,EAAsB,MAAO,CAC/B,MAAMe,EAAmBD,GACvBd,EAAsB,KAC9B,EACM,GAAIe,EAAkB,OAAOA,CAC/B,CACA,OAAOvB,EAAmB,MACtBG,EAAW,MAAM,KACfkB,GAAYA,EAAS,KAAOrB,EAAmB,KACzD,EACQG,EAAW,MAAM,CAAC,GAAK,IAC7B,CACA,OAAOA,EAAW,MAAM,KACtBkB,GAAQ,SAAI,OAAAA,EAAS,OAAO9B,GAAAD,EAAAxC,EAAM,UAAN,YAAAwC,EAAe,WAAf,YAAAC,EAAyB,IACzD,CACA,CAAC,EAEKkC,EAAe3D,EAAS,IAE1BqC,EAAW,MACR,IAAI,CAAC,CAAE,KAAAU,EAAM,GAAAC,EAAI,KAAA3C,CAAI,IAAE,WAAM,OAC5B,MAAO0C,EACP,MAAOC,EACP,MAAO3C,EACP,WAAYkC,EAAa,MACrBS,KAAQd,EAAmB,SAASV,EAAAkC,EAAiB,QAAjB,YAAAlC,EAAwB,KAC5DwB,MAAOtB,GAAAD,EAAAzC,EAAM,UAAN,YAAAyC,EAAe,WAAf,YAAAC,EAAyB,IACpC,OAAQ,gBAChB,EAAQ,EAED,SAAS,CAACwB,EAAGC,IAAM,OAAOA,EAAE,UAAU,EAAI,OAAOD,EAAE,UAAU,CAAC,CAEpE,EAEKU,GAAuB5D,EAAS,IAAM,OAC1C,QAAOwB,EAAAmC,EAAa,QAAb,YAAAnC,EAAoB,QAAS,CACtC,CAAC,EAEKqC,EAAsB,CAAC,CAAE,OAAAC,EAAQ,MAAA1D,KAAY,OACjD,MAAM2D,EAAU,CACd,aAAc,IAAM,CACdxB,EAAa,OACfN,EAAiB,MAAQ7B,EACzBlB,EAAK,YAAakB,CAAK,GAEvBlB,EAAK,cAAe,CAAE,UAAWkB,CAAK,CAAE,EAE1C0B,EAAe,MAAQ,EACzB,EACA,eAAgB,IAAM,CAChBS,EAAa,OACfL,EAAmB,MAAQ9B,EAC3BlB,EAAK,cAAekB,CAAK,GAEzBlB,EAAK,cAAe,CAAE,YAAakB,CAAK,CAAE,EAE5C2B,EAAiB,MAAQ,EAC3B,CACJ,GAEEP,EAAAuC,EAAQD,KAAR,MAAAtC,EAAA,KAAAuC,EACF,EAEMC,GAAaC,GAAQ,CACzB/E,EAAK,cAAe,CAAE,KAAA+E,EAAM,CAC9B,EAEA,OAAApC,GAAU,IAAM,CACd,GAAIa,EAAsB,OAASH,EAAa,MAAO,CAErD,MAAMkB,EAAmBJ,EAAqBX,EAAsB,KAAK,EACrEe,GACFI,EAAoB,CAClB,OAAQ,iBACR,MAAOJ,GAAA,YAAAA,EAAkB,EACjC,CAAO,CAEL,CACF,CAAC,8xECnKD,MAAMzE,EAAQC,EAeRC,EAAOC,EASP,CAAE,EAAAC,CAAC,EAAKC,EAAO,EAEfkD,EAAevC,EAAS,IAAA,OAAM,SAACwB,EAAAxC,EAAM,UAAN,MAAAwC,EAAe,IAAE,EAEhD0C,EAAc9D,GAAS,CAC3BlB,EAAK,cAAekB,CAAK,CAC3B,EAKM+D,EAAY9C,EAChBjB,GAASlB,EAAK,mBAAoBkB,CAAK,EACvC,IACA,EACF,EAMMgE,EAAuB/C,EAAS6C,EAAa,KAAM,EAAK,EAGxDG,EAAsBhD,EAAS6C,EAAa,IAAK,EAAK,EAEtDI,EAAalE,GAAS,CACtBmC,EAAa,MACf8B,EAAoBjE,CAAK,GAEzB+D,EAAU/D,CAAK,EACfgE,EAAqBhE,CAAK,EAE9B,EAEMmE,EAAevE,EAAS,CAC5B,IAAK,IAAMhB,EAAM,QAAQ,MACzB,IAAKoB,GAAS,CACZkE,EAAW,CAAE,MAAOlE,EAAO,CAC7B,CACF,CAAC,EAEKoE,EAAiBxE,EAAS,CAC9B,IAAK,IAAMhB,EAAM,QAAQ,QACzB,IAAKhD,GAAW,CACdsI,EAAW,CAAE,QAAAtI,EAAS,CACxB,CACF,CAAC,EAEKwE,EAAgB,IAAM,CAC1BtB,EAAK,QAAQ,CACf,EAEMuF,EAAcC,GAAY,CAC9BxF,EAAK,YAAawF,CAAQ,CAC5B,EAEMC,EAAgBC,GAAc,CAClC1F,EAAK,cAAe0F,CAAU,CAChC,EAEMnE,EAAiB,IAAM,CAC3BvB,EAAK,gBAAgB,CACvB","x_google_ignoreList":[0]}