import{_ as ee,r as G,n as D,o as O,e as _,l as H,a as b,g as M,p as l,z as te,t as T,H as s,Y as V,c as R,w as Y,f as se,I as ae,i as oe,q as B}from"./_plugin-vue_export-helper-DG4P_01H.js";import{u as y,b as Z,a as le,c as k}from"./useBranding-78t2cBKJ.js";import{n as ne,u as Q,a as ie}from"./Validators-BM89Tp7H.js";import{v as re,r as F,w as ce,t as ue,u as de}from"./dashboard-n_HDIbaW.js";import{u as C}from"./index-CQCyHBIl.js";import{at as _e,x as Ee,p as q,aV as X,c as Te,f as j}from"./DashboardIcon-32bIzNqT.js";import{_ as me}from"./HelpCenterLayout-kAjKzASB.js";import{s as pe}from"./typing-DAnjQ7Xa.js";import{_ as U,c as W,r as z,u as K,b as Re,m as ge,e as Oe,a as Ne}from"./index-Cw6s38ZS.js";import{_ as Se}from"./index-BfMIn2Vn.js";import{B as fe}from"./utils.esm-CMazHLgs.js";import"./index-DN3rM4CW.js";import"./_commonjsHelpers-BosuxZz1.js";import"./useKeyboardNavigableList-BHsyEIUr.js";import"./helper-BVTgYTlr.js";import"./Icon-Br_HG2DA.js";import"./vue-dompurify-html-CEAHYyWB.js";import"./module-CxJOWM_e.js";import"./BarChart-D-eGs9nq.js";import"./constants-lVAyZKq6.js";import"./IframeLoader-LMsN22VU.js";import"./js.cookie-Cz0CWeBA.js";const Ie={class:"flex items-center flex-grow gap-2"},Ae={class:"min-w-0 truncate"},Le={__name:"ColorPicker",props:{modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(g,{emit:p}){const r=p,c=G(!1),n=()=>{c.value=!c.value},i=()=>{c.value&&n()},u=E=>{r("update:modelValue",E.hex)},a=G(null);return(E,N)=>(O(),D("div",{ref_key:"pickerRef",ref:a,class:"relative w-fit"},[_(s(_e),{onTrigger:i},{default:H(()=>[_(U,{color:"slate",icon:"i-lucide-pipette","trailing-icon":"",class:"!px-3 !py-3 [&>svg]:w-4 [&>svg]:h-4",onClick:n},{default:H(()=>[l("div",Ie,[l("span",{class:"rounded-md size-4",style:te({backgroundColor:g.modelValue})},null,4),l("span",Ae,T(g.modelValue),1)])]),_:1}),c.value?(O(),b(s(re.Chrome),{key:0,"disable-alpha":"","model-value":g.modelValue,class:"colorpicker--chrome","onUpdate:modelValue":u},null,8,["model-value"])):M("",!0)]),_:1})],512))}},Pe=ee(Le,[["__scopeId","data-v-b87ee07d"]]),Ce={class:"flex flex-col w-full gap-4"},ve={class:"flex flex-col w-full gap-2"},he={class:"mb-0.5 text-sm font-medium text-gray-900 dark:text-gray-50"},De={class:"flex flex-col w-full gap-4"},xe={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},Ge={class:"text-sm font-medium whitespace-nowrap py-2.5 text-n-slate-12"},Ue={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},Me={class:"text-sm font-medium whitespace-nowrap py-2.5 text-n-slate-12"},be={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},Fe={class:"text-sm font-medium whitespace-nowrap text-n-slate-12 py-2.5"},ye={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},we={class:"text-sm font-medium whitespace-nowrap text-n-slate-12 py-2.5"},He={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},$e={class:"text-sm font-medium whitespace-nowrap py-2.5 text-n-slate-12"},ke={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},Ve={class:"text-sm font-medium whitespace-nowrap py-2.5 text-n-slate-12"},Be={class:"grid items-start justify-between w-full gap-2 grid-cols-[200px,1fr]"},We={class:"text-sm font-medium whitespace-nowrap py-2.5 text-n-slate-12"},ze={class:"w-[432px] justify-start"},qe={class:"flex justify-end w-full gap-2"},J=4,Ke={__name:"PortalBaseSettings",props:{activePortal:{type:Object,required:!0},isFetching:{type:Boolean,default:!1}},emits:["updatePortal"],setup(g,{emit:p}){const r=g,c=p,{t:n}=y(),i=Z(),u=le(),a=V({name:"",headerText:"",pageTitle:"",slug:"",widgetColor:"",homePageLink:"",liveChatWidgetInboxId:"",logoUrl:"",avatarBlobId:""}),E=V({...a}),N=R(()=>{const e=i.getters["inboxes/getInboxes"].filter(o=>o.channel_type==="Channel::WebWidget").map(o=>({value:o.id,label:o.name}));return[{value:"",label:n("HELP_CENTER.PORTAL_SETTINGS.FORM.LIVE_CHAT_WIDGET.NONE_OPTION")},...e]}),m={name:{required:z,minLength:ge(2)},slug:{required:W.withMessage(()=>n("HELP_CENTER.CREATE_PORTAL_DIALOG.SLUG.ERROR"),z),isValidSlug:W.withMessage(()=>n("HELP_CENTER.CREATE_PORTAL_DIALOG.SLUG.FORMAT_ERROR"),ne)},homePageLink:{url:Re}},d=K(m,a),f=R(()=>d.value.name.$error?n("HELP_CENTER.CREATE_PORTAL_DIALOG.NAME.ERROR"):""),I=R(()=>{var t;return((t=d.value.slug.$errors[0])==null?void 0:t.$message)||""}),v=R(()=>d.value.homePageLink.$error?n("HELP_CENTER.PORTAL_SETTINGS.FORM.HOME_PAGE_LINK.ERROR"):""),h=R(()=>{var e,o;const t=(e=r.activePortal)==null?void 0:e.slug;return t?(o=u["portals/uiFlagsIn"].value(t))==null?void 0:o.isUpdating:!1});Y(()=>r.activePortal,t=>{var e;if(t&&!r.isFetching){if(Object.assign(a,{name:t.name,headerText:t.header_text,pageTitle:t.page_title,widgetColor:t.color,homePageLink:t.homepage_link,slug:t.slug,liveChatWidgetInboxId:((e=t.inbox)==null?void 0:e.id)||""}),t.logo){const{logo:{file_url:o,blob_id:w}}=t;a.logoUrl=o,a.avatarBlobId=w}else a.logoUrl="",a.avatarBlobId="";Object.assign(E,a)}},{immediate:!0,deep:!0});const A=R(()=>JSON.stringify(a)!==JSON.stringify(E)),L=()=>{var e;const t={id:(e=r.activePortal)==null?void 0:e.id,slug:a.slug,name:a.name,color:a.widgetColor,page_title:a.pageTitle,header_text:a.headerText,homepage_link:a.homePageLink,blob_id:a.avatarBlobId,inbox_id:a.liveChatWidgetInboxId};c("updatePortal",t)};async function x({file:t}){try{const{fileUrl:e,blobId:o}=await Ee(t);e&&(a.logoUrl=e,a.avatarBlobId=o),C(n("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.IMAGE_UPLOAD_SUCCESS"))}catch{C(n("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.IMAGE_UPLOAD_ERROR"))}}async function S(){var t;try{const e=(t=r.activePortal)==null?void 0:t.slug;await i.dispatch("portals/deleteLogo",{portalSlug:e}),C(n("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.IMAGE_DELETE_SUCCESS"))}catch(e){C((e==null?void 0:e.message)||n("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.IMAGE_DELETE_ERROR"))}}const P=t=>{pe(t,J)?x(t):C(n("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.IMAGE_UPLOAD_SIZE_ERROR",{size:J}))},$=()=>{a.logoUrl="",a.avatarBlobId="",S()};return(t,e)=>(O(),D("div",Ce,[l("div",ve,[l("label",he,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.AVATAR.LABEL")),1),_(Se,{src:a.logoUrl,name:a.name,size:72,"allow-upload":"","icon-name":"i-lucide-building-2",onUpload:P,onDelete:$},null,8,["src","name"])]),l("div",De,[l("div",xe,[l("label",Ge,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.NAME.LABEL")),1),_(F,{modelValue:a.name,"onUpdate:modelValue":e[0]||(e[0]=o=>a.name=o),placeholder:s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.NAME.PLACEHOLDER"),"message-type":f.value?"error":"info",message:f.value,"custom-input-class":"!bg-transparent dark:!bg-transparent",onInput:e[1]||(e[1]=o=>s(d).name.$touch()),onBlur:e[2]||(e[2]=o=>s(d).name.$touch())},null,8,["modelValue","placeholder","message-type","message"])]),l("div",Ue,[l("label",Me,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.HEADER_TEXT.LABEL")),1),_(F,{modelValue:a.headerText,"onUpdate:modelValue":e[3]||(e[3]=o=>a.headerText=o),placeholder:s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.HEADER_TEXT.PLACEHOLDER"),"custom-input-class":"!bg-transparent dark:!bg-transparent"},null,8,["modelValue","placeholder"])]),l("div",be,[l("label",Fe,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.PAGE_TITLE.LABEL")),1),_(F,{modelValue:a.pageTitle,"onUpdate:modelValue":e[4]||(e[4]=o=>a.pageTitle=o),placeholder:s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.PAGE_TITLE.PLACEHOLDER"),"custom-input-class":"!bg-transparent dark:!bg-transparent"},null,8,["modelValue","placeholder"])]),l("div",ye,[l("label",we,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.HOME_PAGE_LINK.LABEL")),1),_(F,{modelValue:a.homePageLink,"onUpdate:modelValue":e[5]||(e[5]=o=>a.homePageLink=o),placeholder:s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.HOME_PAGE_LINK.PLACEHOLDER"),"message-type":v.value?"error":"info",message:v.value,"custom-input-class":"!bg-transparent dark:!bg-transparent",onInput:e[6]||(e[6]=o=>s(d).homePageLink.$touch()),onBlur:e[7]||(e[7]=o=>s(d).homePageLink.$touch())},null,8,["modelValue","placeholder","message-type","message"])]),l("div",He,[l("label",$e,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.SLUG.LABEL")),1),_(F,{modelValue:a.slug,"onUpdate:modelValue":e[8]||(e[8]=o=>a.slug=o),placeholder:s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.SLUG.PLACEHOLDER"),"message-type":I.value?"error":"info",message:I.value||s(ce)(a.slug),"custom-input-class":"!bg-transparent dark:!bg-transparent",onInput:e[9]||(e[9]=o=>s(d).slug.$touch()),onBlur:e[10]||(e[10]=o=>s(d).slug.$touch())},null,8,["modelValue","placeholder","message-type","message"])]),l("div",ke,[l("label",Ve,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.LIVE_CHAT_WIDGET.LABEL")),1),_(ue,{modelValue:a.liveChatWidgetInboxId,"onUpdate:modelValue":e[11]||(e[11]=o=>a.liveChatWidgetInboxId=o),options:N.value,placeholder:s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.LIVE_CHAT_WIDGET.PLACEHOLDER"),message:s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.LIVE_CHAT_WIDGET.HELP_TEXT"),class:"[&>div>button:not(.focused)]:!outline-n-weak"},null,8,["modelValue","options","placeholder","message"])]),l("div",Be,[l("label",We,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.BRAND_COLOR.LABEL")),1),l("div",ze,[_(Pe,{modelValue:a.widgetColor,"onUpdate:modelValue":e[12]||(e[12]=o=>a.widgetColor=o)},null,8,["modelValue"])])]),l("div",qe,[_(U,{label:s(n)("HELP_CENTER.PORTAL_SETTINGS.FORM.SAVE_CHANGES"),disabled:!A.value||h.value||s(d).$invalid,"is-loading":h.value,onClick:L},null,8,["label","disabled","is-loading"])])])]))}},Xe={__name:"AddCustomDomainDialog",props:{mode:{type:String,default:"add"},customDomain:{type:String,default:""}},emits:["addCustomDomain"],setup(g,{expose:p,emit:r}){const c=g,n=r,{t:i}=y(),u=G(null),a=V({customDomain:c.customDomain}),E={customDomain:{isValidDomain:W.withMessage(()=>i("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DIALOG.FORMAT_ERROR"),fe)}},N=K(E,a);Y(()=>c.customDomain,d=>{a.customDomain=d});const m=async()=>{await N.value.$validate()&&n("addCustomDomain",a.customDomain)};return p({dialogRef:u}),(d,f)=>(O(),b(q,{ref_key:"dialogRef",ref:u,title:s(i)(`HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DIALOG.${c.mode.toUpperCase()}_HEADER`),"confirm-button-label":s(i)(`HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DIALOG.${c.mode.toUpperCase()}_CONFIRM_BUTTON_LABEL`),onConfirm:m},{default:H(()=>[_(F,{modelValue:a.customDomain,"onUpdate:modelValue":f[0]||(f[0]=I=>a.customDomain=I),label:s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DIALOG.LABEL"),placeholder:s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DIALOG.PLACEHOLDER"),message:s(N).customDomain.$error?s(N).customDomain.$errors[0].$message:"","message-type":s(N).customDomain.$error?"error":"info",onBlur:f[1]||(f[1]=I=>s(N).customDomain.$touch())},null,8,["modelValue","label","placeholder","message","message-type"])]),_:1},8,["title","confirm-button-label"]))}},Je={class:"flex flex-col gap-6 divide-y divide-n-strong"},Ye={class:"flex flex-col gap-6"},Ze={class:"flex flex-col gap-2 ltr:pr-10 rtl:pl-10"},Qe={class:"text-base font-medium leading-6 text-n-slate-12"},je={class:"mb-0 text-sm text-n-slate-12"},et={class:"flex items-center gap-3 w-full"},tt={class:"min-h-10 px-3 py-2.5 inline-flex items-center w-full text-sm bg-transparent border rounded-lg text-n-slate-11 border-n-strong"},st={class:"flex flex-col gap-6 pt-6"},at={class:"flex flex-col gap-2 ltr:pr-10 rtl:pl-10"},ot={class:"text-base font-medium leading-6 text-n-slate-12"},lt={class:"mb-0 text-sm text-n-slate-12"},nt={__name:"DNSConfigurationDialog",props:{customDomain:{type:String,default:""}},emits:["send","close"],setup(g,{expose:p,emit:r}){const c=g,n=r,{t:i}=y(),u=V({email:""}),E=K({email:{email:Oe,required:z}},u),N=R(()=>{const{hostURL:A,helpCenterURL:L}=(window==null?void 0:window.chatwootConfig)||{};return X(L)||X(A)||""}),m=R(()=>`${c.customDomain} CNAME ${N.value}`),d=async A=>{A.stopPropagation(),await Te(m.value),C(i("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.COPY"))},f=G(null),I=()=>{E.value.$reset(),u.email=""},v=()=>{I(),n("close")},h=async()=>{await E.value.$validate()&&(n("send",u.email),v())};return p({dialogRef:f}),(A,L)=>(O(),b(q,{ref_key:"dialogRef",ref:f,"show-cancel-button":!1,"show-confirm-button":!1,onClose:I},{default:H(()=>[_(U,{icon:"i-lucide-x",sm:"",ghost:"",slate:"",class:"flex-shrink-0 absolute top-2 ltr:right-2 rtl:left-2",onClick:v}),l("div",Je,[l("div",Ye,[l("div",Ze,[l("h3",Qe,T(s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.HEADER")),1),l("p",je,T(s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.DESCRIPTION")),1)]),l("div",et,[l("span",tt,T(m.value),1),_(U,{faded:"",slate:"",type:"button",icon:"i-lucide-copy",class:"flex-shrink-0",onClick:d})])]),l("div",st,[l("div",at,[l("h3",ot,T(s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.SEND_INSTRUCTIONS.HEADER")),1),l("p",lt,T(s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.SEND_INSTRUCTIONS.DESCRIPTION")),1)]),l("form",{class:"flex items-start gap-3 w-full",onSubmit:se(h,["prevent"])},[_(F,{modelValue:u.email,"onUpdate:modelValue":L[0]||(L[0]=x=>u.email=x),placeholder:s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.SEND_INSTRUCTIONS.PLACEHOLDER"),message:s(E).email.$error?s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.SEND_INSTRUCTIONS.ERROR"):"","message-type":s(E).email.$error?"error":"info",class:"w-full",onBlur:L[1]||(L[1]=x=>s(E).email.$touch())},null,8,["modelValue","placeholder","message","message-type"]),_(U,{label:s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DNS_CONFIGURATION_DIALOG.SEND_INSTRUCTIONS.SEND_BUTTON"),type:"submit",class:"flex-shrink-0"},null,8,["label"])],32)])])]),_:1},512))}},it={class:"flex flex-col w-full gap-6"},rt={class:"flex flex-col gap-2"},ct={class:"text-base font-medium text-n-slate-12"},ut={class:"text-sm text-n-slate-11"},dt={class:"flex flex-col w-full gap-4"},_t={class:"flex items-center justify-between w-full gap-2"},Et={key:0,class:"flex flex-col gap-1"},Tt={class:"flex items-center w-full h-8 gap-4"},mt={class:"text-sm font-medium text-n-slate-12"},pt={class:"text-sm text-n-slate-12"},Rt={key:0,class:"text-sm text-n-slate-11"},gt={class:"flex items-center"},Ot={key:0,class:"flex items-center gap-3"},Nt={key:0,class:"flex items-center gap-3 flex-shrink-0"},St={key:1,class:"w-px h-3 bg-n-weak"},ft={key:2,class:"w-px h-3 bg-n-weak"},It={__name:"PortalConfigurationSettings",props:{activePortal:{type:Object,required:!0},isFetchingStatus:{type:Boolean,required:!0}},emits:["updatePortalConfiguration","refreshStatus","sendCnameInstructions"],setup(g,{emit:p}){const r=g,c=p,n={LIVE:["active","staging_active"],PENDING:["provisioned","pending","initializing","pending_validation","pending_deployment","pending_issuance","holding_deployment","holding_validation","pending_expiration","pending_cleanup","pending_deletion","staging_deployment","backup_issued"],ERROR:["blocked","inactive","moved","expired","deleted","timed_out_initializing","timed_out_validation","timed_out_issuance","timed_out_deployment","timed_out_deletion","deactivating"]},{t:i}=y(),{isOnChatwootCloud:u}=j(),a=G(null),E=G(null),N=G(""),m=R(()=>{var t;return((t=r.activePortal)==null?void 0:t.custom_domain)||""}),d=R(()=>{var t;return((t=r.activePortal)==null?void 0:t.ssl_settings)||{}}),f=R(()=>d.value.verification_errors||""),I=R(()=>n.LIVE.includes(d.value.status)),v=R(()=>n.PENDING.includes(d.value.status)),h=R(()=>n.ERROR.includes(d.value.status)),A=R(()=>I.value?i("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.STATUS.LIVE"):v.value?i("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.STATUS.PENDING"):h.value?i("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.STATUS.ERROR"):""),L=R(()=>I.value?{text:"text-n-teal-11",bubble:"outline-n-teal-6 bg-n-teal-9"}:h.value?{text:"text-n-ruby-11",bubble:"outline-n-ruby-6 bg-n-ruby-9"}:{text:"text-n-amber-11",bubble:"outline-n-amber-6 bg-n-amber-9"}),x=t=>{var o;const e={id:(o=r.activePortal)==null?void 0:o.id,custom_domain:t};c("updatePortalConfiguration",e),a.value.dialogRef.close(),t&&(N.value=t,E.value.dialogRef.open())},S=()=>{N.value="",E.value.dialogRef.close()},P=()=>{c("refreshStatus")},$=t=>{var e;c("sendCnameInstructions",{portalSlug:(e=r.activePortal)==null?void 0:e.slug,email:t})};return(t,e)=>{const o=ae("tooltip");return O(),D("div",it,[l("div",rt,[l("h6",ct,T(s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.HEADER")),1),l("span",ut,T(s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.DESCRIPTION")),1)]),l("div",dt,[l("div",_t,[m.value?(O(),D("div",Et,[l("div",Tt,[l("label",mt,T(s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.LABEL")),1),l("span",pt,T(m.value),1)]),!I.value&&s(u)?(O(),D("span",Rt,T(s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.STATUS_DESCRIPTION")),1)):M("",!0)])):M("",!0),l("div",gt,[m.value?(O(),D("div",Ot,[A.value&&s(u)?oe((O(),D("div",Nt,[l("span",{class:B(["size-1.5 rounded-full outline outline-2 block flex-shrink-0",L.value.bubble])},null,2),l("span",{class:B([L.value.text,"text-sm leading-[16px] font-medium"])},T(A.value),3)])),[[o,f.value]]):M("",!0),A.value&&s(u)?(O(),D("div",St)):M("",!0),_(U,{slate:"",sm:"",link:"",label:s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.EDIT_BUTTON"),class:"hover:!no-underline flex-shrink-0",onClick:e[0]||(e[0]=w=>a.value.dialogRef.open())},null,8,["label"]),s(u)?(O(),D("div",ft)):M("",!0),s(u)?(O(),b(U,{key:3,slate:"",sm:"",link:"",icon:"i-lucide-refresh-ccw",class:B(g.isFetchingStatus&&"animate-spin"),onClick:P},null,8,["class"])):M("",!0)])):(O(),b(U,{key:1,label:s(i)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.CUSTOM_DOMAIN.ADD_BUTTON"),color:"slate",onClick:e[1]||(e[1]=w=>a.value.dialogRef.open())},null,8,["label"]))])])]),_(Xe,{ref_key:"addCustomDomainDialogRef",ref:a,mode:m.value?"edit":"add","custom-domain":m.value,onAddCustomDomain:x},null,8,["mode","custom-domain"]),_(nt,{ref_key:"dnsConfigurationDialogRef",ref:E,"custom-domain":N.value||m.value,onClose:S,onSend:$},null,8,["custom-domain"])])}}},At={__name:"ConfirmDeletePortalDialog",props:{activePortalName:{type:String,required:!0}},emits:["deletePortal"],setup(g,{expose:p,emit:r}){const c=r,{t:n}=y(),i=G(null),u=()=>{c("deletePortal")};return p({dialogRef:i}),(a,E)=>(O(),b(q,{ref_key:"dialogRef",ref:i,type:"alert",title:s(n)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.DIALOG.HEADER",{portalName:g.activePortalName}),description:s(n)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.DIALOG.DESCRIPTION"),"confirm-button-label":s(n)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.DIALOG.CONFIRM_BUTTON_LABEL"),onConfirm:u},null,8,["title","description","confirm-button-label"]))}},Lt={key:0,class:"flex items-center justify-center py-10 pt-2 pb-8 text-n-slate-11"},Pt={key:1,class:"flex flex-col w-full gap-4 max-w-[40rem] pb-8"},Ct={class:"flex items-end justify-between w-full gap-4"},vt={class:"flex flex-col gap-2"},ht={class:"text-base font-medium text-n-slate-12"},Dt={class:"text-sm text-n-slate-11"},xt={__name:"PortalSettings",props:{portals:{type:Array,required:!0},isFetching:{type:Boolean,required:!0}},emits:["updatePortal","updatePortalConfiguration","deletePortal","refreshStatus","sendCnameInstructions"],setup(g,{emit:p}){const r=g,c=p,{t:n}=y(),i=Q(),u=G(null),a=R(()=>i.params.portalSlug),E=k("portals/isSwitchingPortal"),N=k("portals/isFetchingSSLStatus"),m=R(()=>{var S;return(S=r.portals)==null?void 0:S.find(P=>P.slug===a.value)}),d=R(()=>{var S;return((S=m.value)==null?void 0:S.name)||""}),f=R(()=>r.isFetching||E.value),I=S=>{c("updatePortal",S)},v=S=>{c("updatePortalConfiguration",S)},h=()=>{c("refreshStatus")},A=S=>{c("sendCnameInstructions",S)},L=()=>{u.value.dialogRef.open()},x=()=>{c("deletePortal",m.value),u.value.dialogRef.close()};return(S,P)=>(O(),b(me,{"show-pagination-footer":!1},{content:H(()=>[f.value?(O(),D("div",Lt,[_(Ne)])):m.value?(O(),D("div",Pt,[_(Ke,{"active-portal":m.value,"is-fetching":g.isFetching,onUpdatePortal:I},null,8,["active-portal","is-fetching"]),P[0]||(P[0]=l("div",{class:"w-full h-px bg-n-weak"},null,-1)),_(It,{"active-portal":m.value,"is-fetching":g.isFetching,"is-fetching-status":s(N),onUpdatePortalConfiguration:v,onRefreshStatus:h,onSendCnameInstructions:A},null,8,["active-portal","is-fetching","is-fetching-status"]),P[1]||(P[1]=l("div",{class:"w-full h-px bg-n-weak"},null,-1)),l("div",Ct,[l("div",vt,[l("h6",ht,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.HEADER")),1),l("span",Dt,T(s(n)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.DESCRIPTION")),1)]),_(U,{label:s(n)("HELP_CENTER.PORTAL_SETTINGS.CONFIGURATION_FORM.DELETE_PORTAL.BUTTON",{portalName:d.value}),color:"ruby",class:"max-w-56 !w-fit",onClick:L},null,8,["label"])])])):M("",!0)]),default:H(()=>[_(At,{ref_key:"confirmDeletePortalDialogRef",ref:u,"active-portal-name":d.value,onDeletePortal:x},null,8,["active-portal-name"])]),_:1}))}},Gt=5e3,ts={__name:"PortalsSettingsIndexPage",setup(g){const{t:p}=y(),r=Z(),c=Q(),n=ie(),{isOnChatwootCloud:i}=j(),{updateUISettings:u}=de(),a=k("portals/allPortals"),E=k("portals/isFetchingPortals"),N=k("portals/portalBySlug"),m=t=>{var e;return((e=a.value)==null?void 0:e.find(o=>o.slug!==t))??null},d=t=>{var e,o;return(o=(e=N.value(t))==null?void 0:e.meta)==null?void 0:o.default_locale},f=()=>{if(!i.value)return;const{portalSlug:t}=c.params;r.dispatch("portals/sslStatus",{portalSlug:t})},I=async(t,e)=>{const o={portalSlug:t,locale:e};await Promise.all([r.dispatch("portals/index"),r.dispatch("portals/show",o),r.dispatch("categories/index",o),r.dispatch("agents/get"),r.dispatch("inboxes/get")])},v=async t=>{const e=m(t);if(e){const{slug:o,meta:{default_locale:w}}=e;await I(o,w),n.push({name:"portals_articles_index",params:{portalSlug:o,locale:w}})}else n.push({name:"portals_new"})},h=async(t,e)=>{await I(t,e),u({last_active_portal_slug:t,last_active_locale_code:e}),await n.replace({name:"portals_settings_index",params:{portalSlug:t}})},A=async t=>{const{portalSlug:e}=c.params;try{const o=d(e);await r.dispatch("portals/update",{...t,portalSlug:e||(t==null?void 0:t.slug)}),t!=null&&t.slug&&e!==t.slug&&await h(t.slug,o),C(p("HELP_CENTER.PORTAL_SETTINGS.API.UPDATE_PORTAL.SUCCESS_MESSAGE"))}catch(o){C((o==null?void 0:o.message)||p("HELP_CENTER.PORTAL_SETTINGS.API.UPDATE_PORTAL.ERROR_MESSAGE"))}},L=async t=>{const{slug:e}=t;try{await r.dispatch("portals/delete",{portalSlug:e}),await v(e),C(p("HELP_CENTER.PORTAL.PORTAL_SETTINGS.DELETE_PORTAL.API.DELETE_SUCCESS"))}catch(o){C((o==null?void 0:o.message)||p("HELP_CENTER.PORTAL.PORTAL_SETTINGS.DELETE_PORTAL.API.DELETE_ERROR"))}},x=async t=>{try{await r.dispatch("portals/sendCnameInstructions",t),C(p("HELP_CENTER.PORTAL.PORTAL_SETTINGS.SEND_CNAME_INSTRUCTIONS.API.SUCCESS_MESSAGE"))}catch(e){C((e==null?void 0:e.message)||p("HELP_CENTER.PORTAL.PORTAL_SETTINGS.SEND_CNAME_INSTRUCTIONS.API.ERROR_MESSAGE"))}},S=A,P=t=>{A(t),t!=null&&t.custom_domain&&i.value&&setTimeout(()=>{f()},Gt)},$=L;return(t,e)=>(O(),b(xt,{portals:s(a),"is-fetching":s(E),onUpdatePortal:s(S),onUpdatePortalConfiguration:P,onDeletePortal:s($),onRefreshStatus:f,onSendCnameInstructions:x},null,8,["portals","is-fetching","onUpdatePortal","onDeletePortal"]))}};export{ts as default};
//# sourceMappingURL=PortalsSettingsIndexPage-C2ot6VnZ.js.map
