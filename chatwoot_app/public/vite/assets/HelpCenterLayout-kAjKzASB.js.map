{"version":3,"file":"HelpCenterLayout-kAjKzASB.js","sources":["../../../app/javascript/dashboard/components-next/HelpCenter/PortalSwitcher/PortalSwitcher.vue","../../../app/javascript/dashboard/components-next/HelpCenter/HelpCenterLayout.vue"],"sourcesContent":["<script setup>\nimport { computed } from 'vue';\nimport { useI18n } from 'vue-i18n';\nimport { useRoute, useRouter } from 'vue-router';\nimport { useMapGetter, useStore } from 'dashboard/composables/store.js';\nimport { buildPortalURL } from 'dashboard/helper/portalHelper';\n\nimport Button from 'dashboard/components-next/button/Button.vue';\nimport Avatar from 'dashboard/components-next/avatar/Avatar.vue';\n\nconst emit = defineEmits(['close', 'createPortal']);\n\nconst { t } = useI18n();\nconst route = useRoute();\nconst router = useRouter();\nconst store = useStore();\n\nconst DEFAULT_ROUTE = 'portals_articles_index';\nconst CATEGORY_ROUTE = 'portals_categories_index';\nconst CATEGORY_SUB_ROUTES = [\n  'portals_categories_articles_index',\n  'portals_categories_articles_edit',\n];\n\nconst portals = useMapGetter('portals/allPortals');\n\nconst currentPortalSlug = computed(() => route.params.portalSlug);\n\nconst portalLink = computed(() => {\n  return buildPortalURL(currentPortalSlug.value);\n});\n\nconst isPortalActive = portal => {\n  return portal.slug === currentPortalSlug.value;\n};\n\nconst getPortalThumbnailSrc = portal => {\n  return portal?.logo?.file_url || '';\n};\n\nconst fetchPortalAndItsCategories = async (slug, locale) => {\n  await store.dispatch('portals/switchPortal', true);\n  await store.dispatch('portals/index');\n  const selectedPortalParam = {\n    portalSlug: slug,\n    locale,\n  };\n  await store.dispatch('portals/show', selectedPortalParam);\n  await store.dispatch('categories/index', selectedPortalParam);\n  await store.dispatch('agents/get');\n  await store.dispatch('portals/switchPortal', false);\n};\n\nconst handlePortalChange = async portal => {\n  if (isPortalActive(portal)) return;\n  const {\n    slug,\n    meta: { default_locale: defaultLocale },\n  } = portal;\n  emit('close');\n  await fetchPortalAndItsCategories(slug, defaultLocale);\n  const targetRouteName = CATEGORY_SUB_ROUTES.includes(route.name)\n    ? CATEGORY_ROUTE\n    : route.name || DEFAULT_ROUTE;\n  router.push({\n    name: targetRouteName,\n    params: {\n      portalSlug: slug,\n      locale: defaultLocale,\n    },\n  });\n};\n\nconst openCreatePortalDialog = () => {\n  emit('createPortal');\n  emit('close');\n};\n\nconst onClickPreviewPortal = () => {\n  window.open(portalLink.value, '_blank');\n};\n\nconst redirectToPortalHomePage = () => {\n  router.push({\n    name: 'portals_index',\n    params: {\n      navigationPath: DEFAULT_ROUTE,\n    },\n  });\n};\n</script>\n\n<template>\n  <div\n    class=\"pt-5 pb-3 bg-n-alpha-3 backdrop-blur-[100px] outline outline-n-container outline-1 z-50 absolute w-[27.5rem] rounded-xl shadow-md flex flex-col gap-4\"\n  >\n    <div\n      class=\"flex items-center justify-between gap-4 px-6 pb-3 border-b border-n-alpha-2\"\n    >\n      <div class=\"flex flex-col gap-1\">\n        <div class=\"flex items-center gap-2\">\n          <h2\n            class=\"text-base font-medium cursor-pointer text-n-slate-12 w-fit hover:underline\"\n            @click=\"redirectToPortalHomePage\"\n          >\n            {{ t('HELP_CENTER.PORTAL_SWITCHER.PORTALS') }}\n          </h2>\n          <Button\n            icon=\"i-lucide-arrow-up-right\"\n            variant=\"ghost\"\n            color=\"slate\"\n            icon-lib=\"lucide\"\n            size=\"sm\"\n            class=\"!w-6 !h-6 hover:bg-n-slate-2 text-n-slate-11 !p-0.5 rounded-md\"\n            @click=\"onClickPreviewPortal\"\n          />\n        </div>\n        <p class=\"text-sm text-n-slate-11\">\n          {{ t('HELP_CENTER.PORTAL_SWITCHER.CREATE_PORTAL') }}\n        </p>\n      </div>\n      <Button\n        :label=\"t('HELP_CENTER.PORTAL_SWITCHER.NEW_PORTAL')\"\n        color=\"slate\"\n        icon=\"i-lucide-plus\"\n        size=\"sm\"\n        class=\"!bg-n-alpha-2 hover:!bg-n-alpha-3\"\n        @click=\"openCreatePortalDialog\"\n      />\n    </div>\n    <div v-if=\"portals.length > 0\" class=\"flex flex-col gap-2 px-4\">\n      <Button\n        v-for=\"(portal, index) in portals\"\n        :key=\"index\"\n        :label=\"portal.name\"\n        variant=\"ghost\"\n        color=\"slate\"\n        trailing-icon\n        :icon=\"isPortalActive(portal) ? 'i-lucide-check' : ''\"\n        class=\"!justify-end !px-2 !py-2 hover:!bg-n-alpha-2 [&>.i-lucide-check]:text-n-teal-10 h-9\"\n        size=\"sm\"\n        @click=\"handlePortalChange(portal)\"\n      >\n        <div v-if=\"portal.custom_domain\" class=\"flex items-center gap-1\">\n          <span class=\"i-lucide-link size-3\" />\n          <span class=\"text-sm truncate text-n-slate-11\">\n            {{ portal.custom_domain || '' }}\n          </span>\n        </div>\n        <span class=\"text-sm font-medium truncate text-n-slate-12\">\n          {{ portal.name || '' }}\n        </span>\n        <Avatar\n          v-if=\"portal\"\n          :name=\"portal.name\"\n          :src=\"getPortalThumbnailSrc(portal)\"\n          :size=\"20\"\n          icon-name=\"i-lucide-building-2\"\n          rounded-full\n        />\n      </Button>\n    </div>\n  </div>\n</template>\n","<script setup>\nimport { ref, computed } from 'vue';\nimport { OnClickOutside } from '@vueuse/components';\nimport { useRoute } from 'vue-router';\nimport { useMapGetter } from 'dashboard/composables/store.js';\n\nimport PaginationFooter from 'dashboard/components-next/pagination/PaginationFooter.vue';\nimport Button from 'dashboard/components-next/button/Button.vue';\nimport PortalSwitcher from 'dashboard/components-next/HelpCenter/PortalSwitcher/PortalSwitcher.vue';\nimport CreatePortalDialog from 'dashboard/components-next/HelpCenter/PortalSwitcher/CreatePortalDialog.vue';\n\ndefineProps({\n  currentPage: {\n    type: Number,\n    default: 1,\n  },\n  totalItems: {\n    type: Number,\n    default: 100,\n  },\n  itemsPerPage: {\n    type: Number,\n    default: 25,\n  },\n  showHeaderTitle: {\n    type: Boolean,\n    default: true,\n  },\n  showPaginationFooter: {\n    type: Boolean,\n    default: true,\n  },\n});\n\nconst emit = defineEmits(['update:currentPage']);\n\nconst route = useRoute();\n\nconst createPortalDialogRef = ref(null);\n\nconst showPortalSwitcher = ref(false);\n\nconst portals = useMapGetter('portals/allPortals');\n\nconst currentPortalSlug = computed(() => route.params.portalSlug);\n\nconst activePortalName = computed(() => {\n  return portals.value?.find(portal => portal.slug === currentPortalSlug.value)\n    ?.name;\n});\n\nconst updateCurrentPage = page => {\n  emit('update:currentPage', page);\n};\nconst togglePortalSwitcher = () => {\n  showPortalSwitcher.value = !showPortalSwitcher.value;\n};\n</script>\n\n<template>\n  <section class=\"flex flex-col w-full h-full overflow-hidden bg-n-background\">\n    <header class=\"sticky top-0 z-10 px-6 pb-3 lg:px-0\">\n      <div class=\"w-full max-w-[60rem] mx-auto lg:px-6\">\n        <div\n          v-if=\"showHeaderTitle\"\n          class=\"flex items-center justify-start h-20 gap-2\"\n        >\n          <span\n            v-if=\"activePortalName\"\n            class=\"text-xl font-medium text-n-slate-12\"\n          >\n            {{ activePortalName }}\n          </span>\n          <div v-if=\"activePortalName\" class=\"relative group\">\n            <OnClickOutside @trigger=\"showPortalSwitcher = false\">\n              <Button\n                icon=\"i-lucide-chevron-down\"\n                variant=\"ghost\"\n                color=\"slate\"\n                size=\"xs\"\n                class=\"rounded-md group-hover:bg-n-slate-3 hover:bg-n-slate-3\"\n                @click=\"togglePortalSwitcher\"\n              />\n\n              <PortalSwitcher\n                v-if=\"showPortalSwitcher\"\n                class=\"absolute ltr:left-0 rtl:right-0 top-9\"\n                @close=\"showPortalSwitcher = false\"\n                @create-portal=\"createPortalDialogRef.dialogRef.open()\"\n              />\n            </OnClickOutside>\n            <CreatePortalDialog ref=\"createPortalDialogRef\" />\n          </div>\n        </div>\n        <slot name=\"header-actions\" />\n      </div>\n    </header>\n    <main class=\"flex-1 px-6 overflow-y-auto lg:px-0\">\n      <div class=\"w-full max-w-[60rem] mx-auto py-3 lg:px-6\">\n        <slot name=\"content\" />\n      </div>\n    </main>\n    <footer v-if=\"showPaginationFooter\" class=\"sticky bottom-0 z-10 px-4 pb-4\">\n      <PaginationFooter\n        :current-page=\"currentPage\"\n        :total-items=\"totalItems\"\n        :items-per-page=\"itemsPerPage\"\n        @update:current-page=\"updateCurrentPage\"\n      />\n    </footer>\n    <!-- Do not remove this slot. It can be used to add dialogs. -->\n    <slot />\n  </section>\n</template>\n"],"names":["DEFAULT_ROUTE","CATEGORY_ROUTE","emit","__emit","t","useI18n","route","useRoute","router","useRouter","store","useStore","CATEGORY_SUB_ROUTES","portals","useMapGetter","currentPortalSlug","computed","portalLink","buildPortalURL","isPortalActive","portal","getPortalThumbnailSrc","_a","fetchPortalAndItsCategories","slug","locale","selectedPortalParam","handlePortalChange","defaultLocale","targetRouteName","openCreatePortalDialog","onClickPreviewPortal","redirectToPortalHomePage","createPortalDialogRef","ref","showPortalSwitcher","activePortalName","_b","updateCurrentPage","page","togglePortalSwitcher"],"mappings":"w+BAiBMA,EAAgB,yBAChBC,GAAiB,wGARvB,MAAMC,EAAOC,EAEP,CAAE,EAAAC,CAAC,EAAKC,EAAO,EACfC,EAAQC,EAAQ,EAChBC,EAASC,EAAS,EAClBC,EAAQC,EAAQ,EAIhBC,EAAsB,CAC1B,oCACA,kCACF,EAEMC,EAAUC,EAAa,oBAAoB,EAE3CC,EAAoBC,EAAS,IAAMV,EAAM,OAAO,UAAU,EAE1DW,EAAaD,EAAS,IACnBE,EAAeH,EAAkB,KAAK,CAC9C,EAEKI,EAAiBC,GACdA,EAAO,OAASL,EAAkB,MAGrCM,EAAwBD,GAAU,OACtC,QAAOE,EAAAF,GAAA,YAAAA,EAAQ,OAAR,YAAAE,EAAc,WAAY,EACnC,EAEMC,EAA8B,MAAOC,EAAMC,IAAW,CAC1D,MAAMf,EAAM,SAAS,uBAAwB,EAAI,EACjD,MAAMA,EAAM,SAAS,eAAe,EACpC,MAAMgB,EAAsB,CAC1B,WAAYF,EACZ,OAAAC,CACJ,EACE,MAAMf,EAAM,SAAS,eAAgBgB,CAAmB,EACxD,MAAMhB,EAAM,SAAS,mBAAoBgB,CAAmB,EAC5D,MAAMhB,EAAM,SAAS,YAAY,EACjC,MAAMA,EAAM,SAAS,uBAAwB,EAAK,CACpD,EAEMiB,EAAqB,MAAMP,GAAU,CACzC,GAAID,EAAeC,CAAM,EAAG,OAC5B,KAAM,CACJ,KAAAI,EACA,KAAM,CAAE,eAAgBI,CAAa,CACzC,EAAMR,EACJlB,EAAK,OAAO,EACZ,MAAMqB,EAA4BC,EAAMI,CAAa,EACrD,MAAMC,EAAkBjB,EAAoB,SAASN,EAAM,IAAI,EAC3DL,GACAK,EAAM,MAAQN,EAClBQ,EAAO,KAAK,CACV,KAAMqB,EACN,OAAQ,CACN,WAAYL,EACZ,OAAQI,CACd,CACA,CAAG,CACH,EAEME,EAAyB,IAAM,CACnC5B,EAAK,cAAc,EACnBA,EAAK,OAAO,CACd,EAEM6B,EAAuB,IAAM,CACjC,OAAO,KAAKd,EAAW,MAAO,QAAQ,CACxC,EAEMe,EAA2B,IAAM,CACrCxB,EAAO,KAAK,CACV,KAAM,gBACN,OAAQ,CACN,eAAgBR,CACtB,CACA,CAAG,CACH,6hECvDA,MAAME,EAAOC,EAEPG,EAAQC,EAAQ,EAEhB0B,EAAwBC,EAAI,IAAI,EAEhCC,EAAqBD,EAAI,EAAK,EAE9BrB,EAAUC,EAAa,oBAAoB,EAE3CC,EAAoBC,EAAS,IAAMV,EAAM,OAAO,UAAU,EAE1D8B,EAAmBpB,EAAS,IAAM,SACtC,OAAOqB,GAAAf,EAAAT,EAAQ,QAAR,YAAAS,EAAe,KAAKF,GAAUA,EAAO,OAASL,EAAkB,SAAhE,YAAAsB,EACH,IACN,CAAC,EAEKC,EAAoBC,GAAQ,CAChCrC,EAAK,qBAAsBqC,CAAI,CACjC,EACMC,EAAuB,IAAM,CACjCL,EAAmB,MAAQ,CAACA,EAAmB,KACjD"}